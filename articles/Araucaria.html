<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>caretSDM Workflow for Species Distribution Modeling • caretSDM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="caretSDM Workflow for Species Distribution Modeling">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">caretSDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Add-Algorithm.html">Adding New Algorithms to caretSDM</a></li>
    <li><a class="dropdown-item" href="../articles/Araucaria.html">caretSDM Workflow for Species Distribution Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/Compact.html">Concatenate functions in caretSDM</a></li>
    <li><a class="dropdown-item" href="../articles/ESM.html">Modeling Rare Species using Ensemble of Small Models</a></li>
    <li><a class="dropdown-item" href="../articles/InvasiveSpp.html">Projecting Non-native Distribution using SDMs</a></li>
    <li><a class="dropdown-item" href="../articles/Salminus.html">Modeling Species Distributions in Continental Water Bodies</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/luizesser/caretSDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>caretSDM Workflow for Species Distribution Modeling</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/luizesser/caretSDM/blob/main/vignettes/articles/Araucaria.Rmd" class="external-link"><code>vignettes/articles/Araucaria.Rmd</code></a></small>
      <div class="d-none name"><code>Araucaria.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>caretSDM</code> is a R package that uses the powerful
<code>caret</code> package as the main engine to obtain Species
Distribution Models. One of its main attributes is the strong
geoprocessing underlying its functions provided by <code>stars</code>
package. Here we show how to model species distributions using
<code>caretSDM</code> through the function <code>sdm_area</code> with a
polygon. We will also show how to apply a PCA in predictors and
scenarios to avoid multicolinearity. The aim of this modeling will be to
obtain the current and future distribution of <em>Araucaria
angustifolia</em>, a keystone tree species from South Brazil.</p>
<p>First, we need to open our library.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://luizesser.github.io/caretSDM/">caretSDM</a></span><span class="op">)</span></span>
<span><span class="va">start_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pre-processing">Pre-Processing<a class="anchor" aria-label="anchor" href="#pre-processing"></a>
</h2>
<p>To obtain models, we will need climatic data and species records. To
easily obtain these data, we have two functions:
<code>WorldClim_data</code> function downloads climatic variables from
WorldClim 2.1, a widely used open-source database; in the same way,
<code>GBIF_data</code> function downloads species records from GBIF,
also a widely used open-source database. You can read more about them by
running in the console <code><a href="../reference/GBIF_data.html">?GBIF_data</a></code> and
<code><a href="../reference/WorldClim_data.html">?WorldClim_data</a></code>.</p>
<div class="section level3">
<h3 id="obtaining-species-records">Obtaining species records<a class="anchor" aria-label="anchor" href="#obtaining-species-records"></a>
</h3>
<p>A easy way to get species data using <code>caretSDM</code> is the
function <code>GBIF_data</code>, which retrieves species records from
GBIF. Understandably, there are other sources of species data available,
as well as our own data that can be the result of field work. In this
sense, one can import to R it’s own data in multiple ways, but be sure
that the table must always have three columns: species, decimalLongitude
and decimalLatitude. <code>GBIF_data</code> function can retrieve the
data ready to be included in caretSDM, thus if you have any doubt on how
to format your own data, use <code>GBIF_data</code> function with the
parameter <code>as_df = TRUE</code> to retrieve an example table. As
standard, <code>GBIF_data</code> function sets
<code>as_df = FALSE</code>, which makes the function return a
<code>occurrences</code> object (more about that further below). An
example code for this step would be:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">occ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GBIF_data.html">GBIF_data</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Araucaria angustifolia"</span><span class="op">)</span>, as_df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>But we already have a <code>occ</code> object included in the
package, which is the same output, but with filtered records to match
our study area. Note that coordinates are in a metric CRS (EPSG:
6933).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">occ</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  species decimalLongitude decimalLatitude</span></span>
<span><span class="co">#&gt; 1 Araucaria angustifolia         -5071809        -3259770</span></span>
<span><span class="co">#&gt; 2 Araucaria angustifolia         -4983891        -3283348</span></span>
<span><span class="co">#&gt; 3 Araucaria angustifolia         -4748996        -3142075</span></span>
<span><span class="co">#&gt; 4 Araucaria angustifolia         -4883188        -3092641</span></span>
<span><span class="co">#&gt; 5 Araucaria angustifolia         -4766386        -3227445</span></span>
<span><span class="co">#&gt; 6 Araucaria angustifolia         -4755861        -3139607</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="obtaining-climatic-data">Obtaining climatic data<a class="anchor" aria-label="anchor" href="#obtaining-climatic-data"></a>
</h3>
<p>For climatic data, we will first download and import current data,
which is used to build the models. <code>WorldClim_data</code> function
has an argument to set the directory in which you want to save the
files. If you don’t set it, files will be saved in your working
directory (run <code><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd()</a></code> to find out your working directory)
in the folder “input_data/WorldClim_data_current/”. If period is set to
“future”, then it is saved in “input_data/WorldClim_data_future/”. We
could run this script with a smaller resolution, but as the aim here is
to show how the package works, we will use a resolution of 10
arc-minutes, which is very coarse, but quicker to download and run.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download current bioclimatic variables</span></span>
<span><span class="fu"><a href="../reference/WorldClim_data.html">WorldClim_data</a></span><span class="op">(</span>path <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>               period <span class="op">=</span> <span class="st">"current"</span>, </span>
<span>               variable <span class="op">=</span> <span class="st">"bioc"</span>, </span>
<span>               resolution <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Import current bioclimatic variables to R</span></span>
<span><span class="va">bioc</span> <span class="op">&lt;-</span> <span class="fu">read_stars</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"input_data/WorldClim_data_current/"</span>, full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, along <span class="op">=</span> <span class="st">"band"</span>, normalize_path <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>As in the previous section, we already have a <code>bioc</code>
object included in the package, which is the same output, but masked to
match our study area and with fewer variables.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bioc</span></span>
<span><span class="co">#&gt; stars object with 3 dimensions and 1 attribute</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;              Min.  1st Qu.   Median     Mean 3rd Qu. Max. NA's</span></span>
<span><span class="co">#&gt; current  14.58698 21.19678 298.9147 622.9417  1353.5 2368 1845</span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;      from  to offset   delta refsys point              values x/y</span></span>
<span><span class="co">#&gt; x     747 798   -180  0.1667 WGS 84 FALSE                NULL [x]</span></span>
<span><span class="co">#&gt; y     670 706     90 -0.1667 WGS 84 FALSE                NULL [y]</span></span>
<span><span class="co">#&gt; band    1   3     NA      NA     NA    NA bio1 , bio4 , bio12</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="defining-the-study-area">Defining the study area<a class="anchor" aria-label="anchor" href="#defining-the-study-area"></a>
</h3>
<p>A important step on model building in Species Distribution Models, is
the definition of accessible area (the M in BAM diagram). This area can
be, in Geographical Information Systems terms, as an example, the
delimitation of a habitat (polygon) or a river basin network (lines).
Another broadly used approach is the use of buffers around presences.
The buffer size translates the potential distribution capabilities of a
species. To educational purposes, we will use a simple polygon of Parana
state boundaries that is available in caretSDM as the
<code>parana</code> object (see <code><a href="../reference/parana.html">?parana</a></code> for more
information on the data)..</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parana</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -54.61834 ymin: -26.71679 xmax: -48.02308 ymax: -22.51621</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt;   GID0 CODIGOIB1 NOMEUF2 SIGLAUF3                           geom</span></span>
<span><span class="co">#&gt; 1   19        41  PARANA       PR MULTIPOLYGON (((-52.06416 -...</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parana</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/tidyverse-methods.html">select_predictors</a></span><span class="op">(</span><span class="va">NOMEUF2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Araucaria_files/figure-html/parana_view-1.png" width="700"></p>
<p>The <code>sdm_area</code> function is responsible to create a grid to
build models, a key aspect of caretSDM workflow. With a grid built,
modelers can pass multiple rasters with different resolutions, CRSs and
extents. The package will be responsible to rescale, transform and crop
every raster to match the grid. The grid returned by the
<code>sdm_area</code> function is from <code>sdm_area</code> class, a
class that will also keep the environmental/climatic data (<em>i.e.</em>
“predictor variables”, “covariates”, “explanatory variables”, “features”
or “control variables”). With this class we will perform analysis using
only the predictors. The grid is built using mostly the first three
arguments: (1) a shape from <code>sf</code> class, but rasters from
<code>stars</code>, <code>rasterStack</code> or <code>SpatRaster</code>
class are also allowed; (2) the cell size of the grid; and (3) the
Coordinate Reference System (CRS). Note that the cell size can be metric
or not depending on the CRS informed. It is important to inform a cell
size bigger than the coarser raster that will be used, otherwise
rescaling process may return empty cells. The rescaling can be performed
using GDAL (quicker but less precise) or the <code>stars</code> package
(slower but more precise). The first will address values to cells by
calculating the mean (for continuous variables) or the median (for
categorical variables) of the values falling within the cell. The
approach using <code>stars</code> will do the same thing, but weighting
for the area of each value within the cell. For other arguments meaning
see <code><a href="../reference/sdm_area.html">?sdm_area</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sdm_area.html">sdm_area</a></span><span class="op">(</span><span class="va">parana</span>, </span>
<span>               cell_size <span class="op">=</span> <span class="fl">25000</span>, </span>
<span>               crs <span class="op">=</span> <span class="fl">6933</span>, </span>
<span>               variables_selected <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               gdal <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>               crop_by <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>               lines_as_sdm_area <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Making grid over study area is an expensive task. Please, be patient!</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span></span>
<span><span class="va">sa</span></span>
<span><span class="co">#&gt;           caretSDM         </span></span>
<span><span class="co">#&gt; ...........................</span></span>
<span><span class="co">#&gt; Class                     : sdm_area</span></span>
<span><span class="co">#&gt; Extent                    : -5276744 -3295037 -4626744 -2795037 (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; CRS                       : WGS 84 / NSIDC EASE- </span></span>
<span><span class="co">#&gt; Resolution                : (25000, 25000) (x, y)</span></span>
<span><span class="co">#&gt; Number of Predictors      : 4 </span></span>
<span><span class="co">#&gt; Predictors Names          : GID0, CODIGOIB1, NOMEUF2, SIGLAUF3</span></span></code></pre></div>
<p>Note that the function returned four predictor variables
(<code>Predictor Names</code> above). These “predictors” are actually
columns included in the <code>parana</code> shape’s data table. One can
filter these variables using <code>select_predictors</code> function,
but we will not do that here, once the package will automatically drop
them further. You can explore the grid generated and stored in the
<code>sdm_area</code> object using the functions
<code><a href="../reference/plot_occurrences.html">mapview_grid()</a></code> or <code><a href="../reference/plot_occurrences.html">plot_grid()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_occurrences.html">plot_grid</a></span><span class="op">(</span><span class="va">sa</span><span class="op">)</span></span></code></pre></div>
<p><img src="Araucaria_files/figure-html/plot_sdm_area-1.png" width="700"></p>
<p>Now that we have a study area, we can assign predictor variables to
it. To do that, we use the <code>add_predictors</code> function, which
usually will only use the fist two arguments, which are the
<code>sdm_area</code> build in the previous step and the
<code>RasterStack</code>, <code>SpatRaster</code> or <code>stars</code>
object with predictors data. Note that <code>add_predictors</code> also
has a <code>gdal</code> argument, which works as the previous one in
<code>sdm_area</code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_predictors.html">add_predictors</a></span><span class="op">(</span><span class="va">sa</span>, </span>
<span>                     <span class="va">bioc</span>, </span>
<span>                     variables_selected <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                     gdal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Making grid over the study area is an expensive task. Please, be patient!</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span></span>
<span><span class="va">sa</span></span>
<span><span class="co">#&gt;           caretSDM         </span></span>
<span><span class="co">#&gt; ...........................</span></span>
<span><span class="co">#&gt; Class                     : sdm_area</span></span>
<span><span class="co">#&gt; Extent                    : -5276744 -3295037 -4626744 -2795037 (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; CRS                       : WGS 84 / NSIDC EASE- </span></span>
<span><span class="co">#&gt; Resolution                : (25000, 25000) (x, y)</span></span>
<span><span class="co">#&gt; Number of Predictors      : 7 </span></span>
<span><span class="co">#&gt; Predictors Names          : GID0, CODIGOIB1, NOMEUF2, SIGLAUF3, bio1, bio4, bio12</span></span></code></pre></div>
<p>Predictors variables are used to train the models. After training the
models, we need to project models into scenarios. Currently, we don’t
have any scenario in our <code>sdm_area</code> object. We can address
the predictors data as the current scenario by applying the function
<code>add_scenario</code> without considering any other argument. This
happens because the argument <code>pred_as_scen</code> is standarly set
to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/add_scenarios.html">add_scenarios</a></span><span class="op">(</span><span class="va">sa</span><span class="op">)</span></span></code></pre></div>
<p>If we are aiming to project species distributions in other scenarios,
we can download data and add in the same way we did for current
data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/WorldClim_data.html">WorldClim_data</a></span><span class="op">(</span>path <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>               period <span class="op">=</span> <span class="st">"future"</span>, </span>
<span>               variable <span class="op">=</span> <span class="st">"bioc"</span>,</span>
<span>               year <span class="op">=</span> <span class="st">"2090"</span>,</span>
<span>               gcm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ca"</span>, <span class="st">"mi"</span><span class="op">)</span>,</span>
<span>               ssp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"245"</span>,<span class="st">"585"</span><span class="op">)</span>,</span>
<span>               resolution <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scen</span> <span class="op">&lt;-</span> <span class="fu">read_stars</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"input_data/WorldClim_data_future/"</span>, full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, along <span class="op">=</span> <span class="st">"band"</span>, normalize_path <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>As with current bioclimatic data, we have already included the
<code>scen</code> object in the package, which is the same output from
above, but masked to match our study area and with fewer variables (see
<code><a href="../reference/scen.html">?scen</a></code> for more information on the data).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scen</span></span>
<span><span class="co">#&gt; stars object with 3 dimensions and 4 attributes</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;                 Min. 1st Qu. Median     Mean  3rd Qu.   Max. NA's</span></span>
<span><span class="co">#&gt; ca_ssp245_2090  18.4  26.100 296.50 570.0926 1188.975 2049.2 1908</span></span>
<span><span class="co">#&gt; ca_ssp585_2090  22.2  31.275 293.25 516.0384 1033.150 1862.2 1908</span></span>
<span><span class="co">#&gt; mi_ssp245_2090  16.3  23.000 314.65 660.9749 1426.800 2414.8 1908</span></span>
<span><span class="co">#&gt; mi_ssp585_2090  17.9  24.500 323.45 702.6153 1534.100 2585.0 1908</span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;      from  to offset   delta refsys point              values x/y</span></span>
<span><span class="co">#&gt; x     747 798   -180  0.1667 WGS 84 FALSE                NULL [x]</span></span>
<span><span class="co">#&gt; y     670 706     90 -0.1667 WGS 84 FALSE                NULL [y]</span></span>
<span><span class="co">#&gt; band    1   3     NA      NA     NA    NA bio1 , bio4 , bio12</span></span></code></pre></div>
<p>Now we can add the current and future scenarios at once in our
<code>sdm_area</code> object. For the meaning on other parameters see
the help file at <code><a href="../reference/add_scenarios.html">?add_scenarios</a></code>. When adding scenarios, the
function will test if all variables are available in all scenarios,
otherwise it will filter predictors (see the warning below). See that we
also provide a stationary argument, where the modeler can inform
variables that do not change between scenarios. These variables can be,
e.g., soil variables.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_scenarios.html">add_scenarios</a></span><span class="op">(</span><span class="va">sa</span>, </span>
<span>                    scen <span class="op">=</span> <span class="va">scen</span>, </span>
<span>                    scenarios_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                    pred_as_scen <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    variables_selected <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                    stationary <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Some variables in `variables_selected` are not present in `scen`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using only variables present in `scen`: bio1, bio4, and bio12</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Making grid over the study area is an expensive task. Please, be patient!</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Making grid over the study area is an expensive task. Please, be patient!</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Making grid over the study area is an expensive task. Please, be patient!</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Making grid over the study area is an expensive task. Please, be patient!</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span></span>
<span><span class="va">sa</span></span>
<span><span class="co">#&gt;           caretSDM         </span></span>
<span><span class="co">#&gt; ...........................</span></span>
<span><span class="co">#&gt; Class                     : sdm_area</span></span>
<span><span class="co">#&gt; Extent                    : -5276744 -3295037 -4626744 -2795037 (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; CRS                       : WGS 84 / NSIDC EASE- </span></span>
<span><span class="co">#&gt; Resolution                : (25000, 25000) (x, y)</span></span>
<span><span class="co">#&gt; Number of Predictors      : 3 </span></span>
<span><span class="co">#&gt; Predictors Names          : bio1, bio4, bio12 </span></span>
<span><span class="co">#&gt; Number of Scenarios      : 5 </span></span>
<span><span class="co">#&gt; Scenarios Names          : ca_ssp245_2090, ca_ssp585_2090, mi_ssp245_2090, mi_ssp585_2090, current</span></span></code></pre></div>
<p>It is common that modelers need to subset variables that will inform
models. This can be due to statistical artifacts that are common in
quarter bioclimatic variables, or a causation subset, aiming for those
variables with causality effect on species distribution. The user may
also want to change scenarios names, predictors names or retrieve
predictors data. For that there are a myriad of functions that can be
found in the package, most of them under the help files of the functions
<code><a href="../reference/add_predictors.html">?add_predictors</a></code> and <code><a href="../reference/add_scenarios.html">?add_scenarios</a></code>, but also
<code><a href="../reference/tidyverse-methods.html">?select_predictors</a></code>.</p>
</div>
<div class="section level3">
<h3 id="defining-the-occurrences-set-in-the-study-area">Defining the occurrences set in the study area<a class="anchor" aria-label="anchor" href="#defining-the-occurrences-set-in-the-study-area"></a>
</h3>
<p>As <code>caretSDM</code> has a strong GIS background, it is necessary
to explicitly tell which CRS is your data in. This will assure that
every GIS transformation is correct. <code>occurrences_sdm</code>
function creates a occurrences class (<em>i.e.</em> “response variable”,
“target” or “label”) that will be used in occurrences’ transformations
and functions, as pseudoabsences generation. For a reference, GBIF data
is in crs = 4326, but our records stored in <code>occ</code> object is
transformed to 6933 (see <code><a href="../reference/occ.html">?occ</a></code> for more information on the
data).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/occurrences_sdm.html">occurrences_sdm</a></span><span class="op">(</span><span class="va">occ</span>, crs <span class="op">=</span> <span class="fl">6933</span><span class="op">)</span></span>
<span><span class="va">oc</span></span>
<span><span class="co">#&gt;         caretSDM       </span></span>
<span><span class="co">#&gt; .......................</span></span>
<span><span class="co">#&gt; Class                 : occurrences</span></span>
<span><span class="co">#&gt; Species Names         : Araucaria angustifolia </span></span>
<span><span class="co">#&gt; Number of presences   : 420 </span></span>
<span><span class="co">#&gt; =================================</span></span>
<span><span class="co">#&gt; Data:</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -5071809 ymin: -3283348 xmax: -4748996 ymax: -3092641</span></span>
<span><span class="co">#&gt; Projected CRS: WGS 84 / NSIDC EASE-Grid 2.0 Global</span></span>
<span><span class="co">#&gt;                  species                  geometry</span></span>
<span><span class="co">#&gt; 1 Araucaria angustifolia POINT (-5071809 -3259770)</span></span>
<span><span class="co">#&gt; 2 Araucaria angustifolia POINT (-4983891 -3283348)</span></span>
<span><span class="co">#&gt; 3 Araucaria angustifolia POINT (-4748996 -3142075)</span></span>
<span><span class="co">#&gt; 4 Araucaria angustifolia POINT (-4883188 -3092641)</span></span>
<span><span class="co">#&gt; 5 Araucaria angustifolia POINT (-4766386 -3227445)</span></span>
<span><span class="co">#&gt; 6 Araucaria angustifolia POINT (-4755861 -3139607)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_occurrences.html">plot_occurrences</a></span><span class="op">(</span><span class="va">oc</span><span class="op">)</span></span></code></pre></div>
<p><img src="Araucaria_files/figure-html/plot_occurrences-1.png" width="700"></p>
<p>This next step assigns occurrences into a study area, excluding
records outside the study area or with NAs as predictors.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/join_area.html">join_area</a></span><span class="op">(</span><span class="va">oc</span>, <span class="va">sa</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Some records from `occ` do not fall in `pred`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> 2 elements from `occ` were excluded.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> If this seems too much, check how `occ` and `pred` intersect.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-input_sdm-class">The <code>input_sdm</code> class<a class="anchor" aria-label="anchor" href="#the-input_sdm-class"></a>
</h3>
<p>In <code>caretSDM</code> we use multiple classes to perform our
analysis. Every time we perform a new analysis, objects keep the
information of what we did. Ideally, the workflow will have only one
object throughout it. The <code>input_sdm</code> class is the key class
in the workflow, where every function will orbitate. That class puts
occurrences, predictors, scenarios, models and predictions together to
perform analysis that are only possible when two or more of these
classes are available. First, we create the object by informing the
occurrences and the sdm_area.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/input_sdm.html">input_sdm</a></span><span class="op">(</span><span class="va">oc</span>, <span class="va">sa</span><span class="op">)</span></span>
<span><span class="va">i</span></span>
<span><span class="co">#&gt;             caretSDM           </span></span>
<span><span class="co">#&gt; ...............................</span></span>
<span><span class="co">#&gt; Class                         : input_sdm</span></span>
<span><span class="co">#&gt; --------  Occurrences  --------</span></span>
<span><span class="co">#&gt; Species Names                 : Araucaria angustifolia </span></span>
<span><span class="co">#&gt; Number of presences           : 418 </span></span>
<span><span class="co">#&gt; --------  Predictors  ---------</span></span>
<span><span class="co">#&gt; Number of Predictors          : 3 </span></span>
<span><span class="co">#&gt; Predictors Names              : bio1, bio4, bio12 </span></span>
<span><span class="co">#&gt; ---------  Scenarios  ---------</span></span>
<span><span class="co">#&gt; Number of Scenarios           : 5 </span></span>
<span><span class="co">#&gt; Scenarios Names               : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-cleaning-routine">Data cleaning routine<a class="anchor" aria-label="anchor" href="#data-cleaning-routine"></a>
</h3>
<p>As the first step in our workflow with the <code>input_sdm</code>
object, we will clean our occurrences data by applying a group of
functions from the package <code>CoordinateCleaner</code>. In this
function, we also provide a way to check for environmental duplicates,
by including a predictors object. This function also checks for records
in the sea if the species is terrestrial, but note that this can be
switched off if the studied species is not terrestrial. The way
<code>caretSDM</code> works, we can always overwrite the main
<code>input_sdm</code> object to update it. The function will return a
new object with all the previous information and the new information
obtained from the <code>data_clean</code> function, note that at the end
of the Data Cleaning information there is the Duplicated Cell method.
This method is only possible when we have both the
<code>occurrence</code> and <code>predictors</code> data.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_clean.html">data_clean</a></span><span class="op">(</span><span class="va">i</span>,</span>
<span>                capitals <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                centroids <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                duplicated <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                identical <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                institutions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                invalid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                terrestrial <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cell_ids identified, removing duplicated cell_id.</span></span>
<span><span class="co">#&gt; Testing country capitals</span></span>
<span><span class="co">#&gt; Removed 0 records.</span></span>
<span><span class="co">#&gt; Testing country centroids</span></span>
<span><span class="co">#&gt; Removed 0 records.</span></span>
<span><span class="co">#&gt; Testing duplicates</span></span>
<span><span class="co">#&gt; Removed 0 records.</span></span>
<span><span class="co">#&gt; Testing equal lat/lon</span></span>
<span><span class="co">#&gt; Removed 0 records.</span></span>
<span><span class="co">#&gt; Testing biodiversity institutions</span></span>
<span><span class="co">#&gt; Removed 1 records.</span></span>
<span><span class="co">#&gt; Testing coordinate validity</span></span>
<span><span class="co">#&gt; Removed 0 records.</span></span>
<span><span class="co">#&gt; Testing sea coordinates</span></span>
<span><span class="co">#&gt; Reading <span style="color: #0000BB;">ne_110m_land.zip</span> from naturalearth...</span></span>
<span><span class="co">#&gt; Removed 0 records.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictors identified, procceding with grid filter (removing NA and duplicated data).</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="removing-multicolinearity-from-predictors-data">Removing multicolinearity from predictors’ data<a class="anchor" aria-label="anchor" href="#removing-multicolinearity-from-predictors-data"></a>
</h3>
<p>There are two main methods in the SDM literature to consider
multicolinearity in predictors data. One is the use of VIFs, which in
<code>caretSDM</code> is performed using
<code>vif_predictors</code>function. There, users are able to perform
variables selection through <code>usdm</code> package. The function is a
wrapper for <code><a href="https://rdrr.io/pkg/usdm/man/vif.html" class="external-link">usdm::vifcor</a></code>, where variables are kept given a
maximum threshold of colinearity. The standard is 0.5. Here is a example
code for demonstration:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vif_predictors.html">vif_predictors</a></span><span class="op">(</span><span class="va">i</span>, </span>
<span>                    th <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                    maxobservations <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                    variables_selected <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>For this study, however, we will use the PCA approach to
multicolinearity, where we synthesize environmental variability into
PCA-axis and project these axis to the geographic space to use them as
predictors. <code>pca_predictors</code> does not have arguments other
than the <code>input_sdm</code> object. PCA-axis will be included in
predictors together with raw variables.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pca_predictors.html">pca_predictors</a></span><span class="op">(</span><span class="va">i</span>, cumulative_proportion <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">i</span></span>
<span><span class="co">#&gt;             caretSDM           </span></span>
<span><span class="co">#&gt; ...............................</span></span>
<span><span class="co">#&gt; Class                         : input_sdm</span></span>
<span><span class="co">#&gt; --------  Occurrences  --------</span></span>
<span><span class="co">#&gt; Species Names                 : Araucaria angustifolia </span></span>
<span><span class="co">#&gt; Number of presences           : 84 </span></span>
<span><span class="co">#&gt; Data Cleaning                 : NAs, Capitals, Centroids, Geographically Duplicated, Identical Lat/Long, Institutions, Invalid, Non-terrestrial, Duplicated Cell (grid) </span></span>
<span><span class="co">#&gt; --------  Predictors  ---------</span></span>
<span><span class="co">#&gt; Number of Predictors          : 6 </span></span>
<span><span class="co">#&gt; Predictors Names              : bio1, bio4, bio12, PC1, PC2, PC3 </span></span>
<span><span class="co">#&gt; PCA-transformed variables     : DONE </span></span>
<span><span class="co">#&gt; Cummulative proportion ( 1 ) : PC1, PC2, PC3 </span></span>
<span><span class="co">#&gt; ---------  Scenarios  ---------</span></span>
<span><span class="co">#&gt; Number of Scenarios           : 5 </span></span>
<span><span class="co">#&gt; Scenarios Names               : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current</span></span></code></pre></div>
<p>To better visualize PCA parameters, users can run
<code>pca_summary</code> and <code>get_pca_model</code> functions, which
are very self-explanatory.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pca_predictors.html">pca_summary</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="co">#&gt; Importance of components:</span></span>
<span><span class="co">#&gt;                             PC1      PC2     PC3</span></span>
<span><span class="co">#&gt; Standard deviation     204.4810 16.52253 1.55697</span></span>
<span><span class="co">#&gt; Proportion of Variance   0.9935  0.00649 0.00006</span></span>
<span><span class="co">#&gt; Cumulative Proportion    0.9935  0.99994 1.00000</span></span>
<span><span class="fu"><a href="../reference/pca_predictors.html">get_pca_model</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="co">#&gt; Standard deviations (1, .., p=3):</span></span>
<span><span class="co">#&gt; [1] 204.480951  16.522529   1.556971</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rotation (n x k) = (3 x 3):</span></span>
<span><span class="co">#&gt;                PC1          PC2          PC3</span></span>
<span><span class="co">#&gt; bio1  -0.004403833 -0.006704105 -0.999967830</span></span>
<span><span class="co">#&gt; bio4   0.995793285  0.091491771 -0.004998839</span></span>
<span><span class="co">#&gt; bio12  0.091522341 -0.995783265  0.006272988</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="obtaining-pseudoabsence-data">Obtaining pseudoabsence data<a class="anchor" aria-label="anchor" href="#obtaining-pseudoabsence-data"></a>
</h3>
<p>Pseudoabsence data will be stored in the <code>occurrences</code>
object (inside the <code>input_sdm</code>). To generate them, you must
inform some parameters. Probably one of the most important arguments in
this function is the <code>method</code>. Currently, two methods are
implemented: a “random”, which takes random grid cells as
pseudoabsences; and a “bioclim” method, which creates a Surface Range
Envelope (SRE) using presence records, binarizes the projection of the
SRE using the <code>th</code> threshold and then retrieves
pseudoabsences outside the envelope. The number of pseudoabsences
created can be changed using the <code>n_pa</code> parameter. When set
to NULL, <code>n_pa</code> will be equal the number of occurrences (to
avoid imbalance issues). The number of sets of pseudoabsences is
adjusted with the <code>n_set</code> parameter in the function. The
argument <code>variables_selected</code> will inform which variables you
want to use to build your pseudoabsences/models. This can either be a
vector of variables names or a previously performed selection
method.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pseudoabsences.html">pseudoabsences</a></span><span class="op">(</span><span class="va">i</span>, </span>
<span>                    method <span class="op">=</span> <span class="st">"bioclim"</span>, </span>
<span>                    n_set <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                    n_pa <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                    variables_selected <span class="op">=</span> <span class="st">"pca"</span>,</span>
<span>                    th <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> </span>
<span><span class="va">i</span></span>
<span><span class="co">#&gt;             caretSDM           </span></span>
<span><span class="co">#&gt; ...............................</span></span>
<span><span class="co">#&gt; Class                         : input_sdm</span></span>
<span><span class="co">#&gt; --------  Occurrences  --------</span></span>
<span><span class="co">#&gt; Species Names                 : Araucaria angustifolia </span></span>
<span><span class="co">#&gt; Number of presences           : 84 </span></span>
<span><span class="co">#&gt; Pseudoabsence methods         :</span></span>
<span><span class="co">#&gt;     Method to obtain PAs      : bioclim </span></span>
<span><span class="co">#&gt;     Number of PA sets         : 10 </span></span>
<span><span class="co">#&gt;     Number of PAs in each set : 84 </span></span>
<span><span class="co">#&gt; Data Cleaning                 : NAs, Capitals, Centroids, Geographically Duplicated, Identical Lat/Long, Institutions, Invalid, Non-terrestrial, Duplicated Cell (grid) </span></span>
<span><span class="co">#&gt; --------  Predictors  ---------</span></span>
<span><span class="co">#&gt; Number of Predictors          : 6 </span></span>
<span><span class="co">#&gt; Predictors Names              : bio1, bio4, bio12, PC1, PC2, PC3 </span></span>
<span><span class="co">#&gt; PCA-transformed variables     : DONE </span></span>
<span><span class="co">#&gt; Cummulative proportion ( 1 ) : PC1, PC2, PC3 </span></span>
<span><span class="co">#&gt; ---------  Scenarios  ---------</span></span>
<span><span class="co">#&gt; Number of Scenarios           : 5 </span></span>
<span><span class="co">#&gt; Scenarios Names               : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="processing">Processing<a class="anchor" aria-label="anchor" href="#processing"></a>
</h2>
<div class="section level3">
<h3 id="modeling-species-relationship-with-variables">Modeling species relationship with variables<a class="anchor" aria-label="anchor" href="#modeling-species-relationship-with-variables"></a>
</h3>
<p>With the occurrences and predictors data put together, we can pass to
the modeling. As the name suggests, <code>caretSDM</code> uses the
<code>caret</code> package underlying its modeling procedure. For those
who are not familiar, <code>caret</code> is the easiest way to perform
Machine Learning analysis in R. It works by setting a modeling wrapper
to pass multiple packages and can provide a lot of automation regarding
algorithms fine-tuning, data spliting, pre-processing methods and
predictions. These automated functions from <code>caret</code> can be
altered using the <code>ctrl</code> argument in <code>train_sdm</code>
function. See <code><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">?caret::trainControl</a></code> for all options
available.</p>
<p>We show here how to use a repeated crossvalidation method, which is
defined through <code><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">caret::trainControl</a></code>.</p>
<p>Note that, when you are using an algorithm for the first time, caret
will ask you to install the relevant packages to properly run the
algorithm.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ctrl_sdm</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">trainControl</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"repeatedcv"</span>, </span>
<span>                                number <span class="op">=</span> <span class="fl">4</span>, </span>
<span>                                repeats <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                classProbs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                returnResamp <span class="op">=</span> <span class="st">"all"</span>, </span>
<span>                                summaryFunction <span class="op">=</span> <span class="va">summary_sdm</span>, </span>
<span>                                savePredictions <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train_sdm.html">train_sdm</a></span><span class="op">(</span><span class="va">i</span>, </span>
<span>               algo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"naive_bayes"</span>, <span class="st">"kknn"</span><span class="op">)</span>, </span>
<span>               variables_selected <span class="op">=</span> <span class="st">"pca"</span>, </span>
<span>               ctrl<span class="op">=</span><span class="va">ctrl_sdm</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: lattice</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'caret'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:caretSDM':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     predictors</span></span>
<span><span class="va">i</span></span>
<span><span class="co">#&gt;             caretSDM           </span></span>
<span><span class="co">#&gt; ...............................</span></span>
<span><span class="co">#&gt; Class                         : input_sdm</span></span>
<span><span class="co">#&gt; --------  Occurrences  --------</span></span>
<span><span class="co">#&gt; Species Names                 : Araucaria angustifolia </span></span>
<span><span class="co">#&gt; Number of presences           : 84 </span></span>
<span><span class="co">#&gt; Pseudoabsence methods         :</span></span>
<span><span class="co">#&gt;     Method to obtain PAs      : bioclim </span></span>
<span><span class="co">#&gt;     Number of PA sets         : 10 </span></span>
<span><span class="co">#&gt;     Number of PAs in each set : 84 </span></span>
<span><span class="co">#&gt; Data Cleaning                 : NAs, Capitals, Centroids, Geographically Duplicated, Identical Lat/Long, Institutions, Invalid, Non-terrestrial, Duplicated Cell (grid) </span></span>
<span><span class="co">#&gt; --------  Predictors  ---------</span></span>
<span><span class="co">#&gt; Number of Predictors          : 6 </span></span>
<span><span class="co">#&gt; Predictors Names              : bio1, bio4, bio12, PC1, PC2, PC3 </span></span>
<span><span class="co">#&gt; PCA-transformed variables     : DONE </span></span>
<span><span class="co">#&gt; Cummulative proportion ( 1 ) : PC1, PC2, PC3 </span></span>
<span><span class="co">#&gt; ---------  Scenarios  ---------</span></span>
<span><span class="co">#&gt; Number of Scenarios           : 5 </span></span>
<span><span class="co">#&gt; Scenarios Names               : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current </span></span>
<span><span class="co">#&gt; -----------  Models  ----------</span></span>
<span><span class="co">#&gt; Algorithms Names              : naive_bayes kknn </span></span>
<span><span class="co">#&gt; Variables Names               : PC1 PC2 PC3 </span></span>
<span><span class="co">#&gt; Model Validation              :</span></span>
<span><span class="co">#&gt;     Method                    : repeatedcv </span></span>
<span><span class="co">#&gt;     Number                    : 4 </span></span>
<span><span class="co">#&gt;     Metrics                   :</span></span>
<span><span class="co">#&gt; $`Araucaria angustifolia`</span></span>
<span><span class="co">#&gt;          algo       ROC       TSS Sensitivity Specificity</span></span>
<span><span class="co">#&gt; 1        kknn 0.9660175 0.8737179     0.96895    0.905850</span></span>
<span><span class="co">#&gt; 2 naive_bayes 0.9759408 0.9047619     0.98205    0.922625</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="post-processing">Post-Processing<a class="anchor" aria-label="anchor" href="#post-processing"></a>
</h2>
<div class="section level3">
<h3 id="predicting-species-distribution-in-given-scenarios">Predicting species distribution in given scenarios<a class="anchor" aria-label="anchor" href="#predicting-species-distribution-in-given-scenarios"></a>
</h3>
<p>Now that we have our models, we can make predictions in new
scenarios. The function <code>predict_sdm</code> incorporates also the
prediction of ensembles (<code>ensembles=TRUE</code> is standard). The
function will only predict models that passes a given validation
threshold. This validation metric is set using <code>metric</code> and
<code>th</code> arguments. In the following example, metric is set to be
“ROC” and th is equal 0.9. This means that only models with ROC &gt; 0.9
will be used in predictions and ensembles.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_sdm.html">predict_sdm</a></span><span class="op">(</span><span class="va">i</span>,</span>
<span>                 metric <span class="op">=</span> <span class="st">"ROC"</span>,</span>
<span>                 th <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>                 tp <span class="op">=</span> <span class="st">"prob"</span>,</span>
<span>                 ensembles <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Projecting: 1/5"</span></span>
<span><span class="co">#&gt; [1] "Projecting: 2/5"</span></span>
<span><span class="co">#&gt; [1] "Projecting: 3/5"</span></span>
<span><span class="co">#&gt; [1] "Projecting: 4/5"</span></span>
<span><span class="co">#&gt; [1] "Projecting: 5/5"</span></span>
<span><span class="co">#&gt; [1] "Ensembling..."</span></span>
<span><span class="co">#&gt; [1] "ca_ssp245_2090"</span></span>
<span><span class="co">#&gt; [1] "Araucaria angustifolia"</span></span>
<span><span class="co">#&gt; [1] "ca_ssp585_2090"</span></span>
<span><span class="co">#&gt; [1] "Araucaria angustifolia"</span></span>
<span><span class="co">#&gt; [1] "mi_ssp245_2090"</span></span>
<span><span class="co">#&gt; [1] "Araucaria angustifolia"</span></span>
<span><span class="co">#&gt; [1] "mi_ssp585_2090"</span></span>
<span><span class="co">#&gt; [1] "Araucaria angustifolia"</span></span>
<span><span class="co">#&gt; [1] "current"</span></span>
<span><span class="co">#&gt; [1] "Araucaria angustifolia"</span></span>
<span><span class="va">i</span></span>
<span><span class="co">#&gt;             caretSDM           </span></span>
<span><span class="co">#&gt; ...............................</span></span>
<span><span class="co">#&gt; Class                         : input_sdm</span></span>
<span><span class="co">#&gt; --------  Occurrences  --------</span></span>
<span><span class="co">#&gt; Species Names                 : Araucaria angustifolia </span></span>
<span><span class="co">#&gt; Number of presences           : 84 </span></span>
<span><span class="co">#&gt; Pseudoabsence methods         :</span></span>
<span><span class="co">#&gt;     Method to obtain PAs      : bioclim </span></span>
<span><span class="co">#&gt;     Number of PA sets         : 10 </span></span>
<span><span class="co">#&gt;     Number of PAs in each set : 84 </span></span>
<span><span class="co">#&gt; Data Cleaning                 : NAs, Capitals, Centroids, Geographically Duplicated, Identical Lat/Long, Institutions, Invalid, Non-terrestrial, Duplicated Cell (grid) </span></span>
<span><span class="co">#&gt; --------  Predictors  ---------</span></span>
<span><span class="co">#&gt; Number of Predictors          : 6 </span></span>
<span><span class="co">#&gt; Predictors Names              : bio1, bio4, bio12, PC1, PC2, PC3 </span></span>
<span><span class="co">#&gt; PCA-transformed variables     : DONE </span></span>
<span><span class="co">#&gt; Cummulative proportion ( 1 ) : PC1, PC2, PC3 </span></span>
<span><span class="co">#&gt; ---------  Scenarios  ---------</span></span>
<span><span class="co">#&gt; Number of Scenarios           : 5 </span></span>
<span><span class="co">#&gt; Scenarios Names               : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current </span></span>
<span><span class="co">#&gt; -----------  Models  ----------</span></span>
<span><span class="co">#&gt; Algorithms Names              : naive_bayes kknn </span></span>
<span><span class="co">#&gt; Variables Names               : PC1 PC2 PC3 </span></span>
<span><span class="co">#&gt; Model Validation              :</span></span>
<span><span class="co">#&gt;     Method                    : repeatedcv </span></span>
<span><span class="co">#&gt;     Number                    : 4 </span></span>
<span><span class="co">#&gt;     Metrics                   :</span></span>
<span><span class="co">#&gt; $`Araucaria angustifolia`</span></span>
<span><span class="co">#&gt;          algo       ROC       TSS Sensitivity Specificity</span></span>
<span><span class="co">#&gt; 1        kknn 0.9660175 0.8737179     0.96895    0.905850</span></span>
<span><span class="co">#&gt; 2 naive_bayes 0.9759408 0.9047619     0.98205    0.922625</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------  Predictions  --------</span></span>
<span><span class="co">#&gt; Ensembles                     :</span></span>
<span><span class="co">#&gt;     Scenarios                 : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current </span></span>
<span><span class="co">#&gt;     Methods                   : mean_occ_prob wmean_AUC committee_avg </span></span>
<span><span class="co">#&gt; Thresholds                    :</span></span>
<span><span class="co">#&gt;     Method                    : threshold </span></span>
<span><span class="co">#&gt;     Criteria                  : 0.9</span></span></code></pre></div>
<p>In the above print, it is possible to see the “Methods” under the
“Predictions” section, which informs which ensemble types were made:
mean occurrence probability (<code>mean_occ_prob</code>; a simple mean
between GCMs), mean occurrence probability weighted by AUC/ROC
(<code>wmean_AUC</code>; AUC/ROC values are used as weights), and the
majority rule, or the committee average (<code>committee_avg</code>; the
sum of binaries).</p>
<p>Besides the AUC/ROC metric, users can get every available metric by
model using the following code before commit to “ROC”:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/train_sdm.html">get_validation_metrics</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`Araucaria angustifolia`</span></span>
<span><span class="co">#&gt;              algo       ROC       TSS Sensitivity Specificity Pos Pred Value</span></span>
<span><span class="co">#&gt; m1.2         kknn 0.9709631 0.9006410     1.00000     0.90075        0.94625</span></span>
<span><span class="co">#&gt; m2.2         kknn 0.9606227 0.9139194     0.95200     0.96150        0.97600</span></span>
<span><span class="co">#&gt; m3.2         kknn 0.9665751 0.8608059     0.97625     0.88450        0.93200</span></span>
<span><span class="co">#&gt; m4.2         kknn 0.9884386 0.8665293     0.97600     0.90225        0.94500</span></span>
<span><span class="co">#&gt; m5.2         kknn 0.9418117 0.8546245     0.95225     0.90225        0.94425</span></span>
<span><span class="co">#&gt; m6.2         kknn 0.9587912 0.8782051     0.95250     0.92575        0.95375</span></span>
<span><span class="co">#&gt; m7.2         kknn 0.9770408 0.8543956     0.96400     0.89025        0.93275</span></span>
<span><span class="co">#&gt; m8.2         kknn 0.9752747 0.8518773     0.98800     0.86375        0.92525</span></span>
<span><span class="co">#&gt; m9.2         kknn 0.9606227 0.8706502     0.95225     0.91825        0.95375</span></span>
<span><span class="co">#&gt; m10.2        kknn 0.9600340 0.8855311     0.97625     0.90925        0.94325</span></span>
<span><span class="co">#&gt; m1.1  naive_bayes 0.9617674 0.8559982     0.97600     0.87975        0.93450</span></span>
<span><span class="co">#&gt; m2.1  naive_bayes 0.9830586 0.9377289     0.97600     0.96150        0.97675</span></span>
<span><span class="co">#&gt; m3.1  naive_bayes 0.9734432 0.8727106     0.98800     0.88450        0.93300</span></span>
<span><span class="co">#&gt; m4.1  naive_bayes 0.9505495 0.8592033     0.97625     0.88300        0.93375</span></span>
<span><span class="co">#&gt; m5.1  naive_bayes 0.9970238 0.9271978     0.98800     0.93900        0.96600</span></span>
<span><span class="co">#&gt; m6.1  naive_bayes 0.9895343 0.9510073     0.98800     0.96300        0.97675</span></span>
<span><span class="co">#&gt; m7.1  naive_bayes 0.9927394 0.9079670     0.96425     0.94375        0.96425</span></span>
<span><span class="co">#&gt; m8.1  naive_bayes 0.9851954 0.8903388     0.98800     0.90225        0.94550</span></span>
<span><span class="co">#&gt; m9.1  naive_bayes 0.9684829 0.9361264     0.97600     0.96000        0.97675</span></span>
<span><span class="co">#&gt; m10.1 naive_bayes 0.9576138 0.9093407     1.00000     0.90950        0.94625</span></span>
<span><span class="co">#&gt;       Neg Pred Value Precision  Recall      F1 Prevalence Detection Rate</span></span>
<span><span class="co">#&gt; m1.2         1.00000   0.94625 1.00000 0.97175     0.6315        0.63150</span></span>
<span><span class="co">#&gt; m2.2         0.92600   0.97600 0.95200 0.96400     0.6180        0.58800</span></span>
<span><span class="co">#&gt; m3.2         0.96150   0.93200 0.97625 0.95350     0.6180        0.60325</span></span>
<span><span class="co">#&gt; m4.2         0.96000   0.94500 0.97600 0.95350     0.6225        0.60750</span></span>
<span><span class="co">#&gt; m5.2         0.93075   0.94425 0.95225 0.94650     0.6270        0.59725</span></span>
<span><span class="co">#&gt; m6.2         0.93100   0.95375 0.95250 0.95225     0.6135        0.58450</span></span>
<span><span class="co">#&gt; m7.2         0.94375   0.93275 0.96400 0.94725     0.6090        0.58675</span></span>
<span><span class="co">#&gt; m8.2         0.97500   0.92525 0.98800 0.95525     0.6225        0.61500</span></span>
<span><span class="co">#&gt; m9.2         0.92425   0.95375 0.95225 0.95250     0.6315        0.60175</span></span>
<span><span class="co">#&gt; m10.2        0.96425   0.94325 0.97625 0.95925     0.6045        0.59025</span></span>
<span><span class="co">#&gt; m1.1         0.95800   0.93450 0.97600 0.95425     0.6315        0.61650</span></span>
<span><span class="co">#&gt; m2.1         0.96300   0.97675 0.97600 0.97625     0.6180        0.60300</span></span>
<span><span class="co">#&gt; m3.1         0.97925   0.93300 0.98800 0.95975     0.6180        0.61050</span></span>
<span><span class="co">#&gt; m4.1         0.96425   0.93375 0.97625 0.95350     0.6225        0.60775</span></span>
<span><span class="co">#&gt; m5.1         0.97725   0.96600 0.98800 0.97675     0.6270        0.61950</span></span>
<span><span class="co">#&gt; m6.1         0.98225   0.97675 0.98800 0.98225     0.6135        0.60625</span></span>
<span><span class="co">#&gt; m7.1         0.95000   0.96425 0.96425 0.96350     0.6090        0.58675</span></span>
<span><span class="co">#&gt; m8.1         0.98075   0.94550 0.98800 0.96550     0.6225        0.61500</span></span>
<span><span class="co">#&gt; m9.1         0.96000   0.97675 0.97600 0.97625     0.6315        0.61650</span></span>
<span><span class="co">#&gt; m10.1        1.00000   0.94625 1.00000 0.97175     0.6045        0.60450</span></span>
<span><span class="co">#&gt;       Detection Prevalence Balanced Accuracy Accuracy   Kappa AccuracyLower</span></span>
<span><span class="co">#&gt; m1.2               0.66900           0.95025  0.96300 0.91775       0.83525</span></span>
<span><span class="co">#&gt; m2.2               0.60300           0.95700  0.95600 0.90700       0.82500</span></span>
<span><span class="co">#&gt; m3.2               0.64700           0.93050  0.94125 0.87425       0.80550</span></span>
<span><span class="co">#&gt; m4.2               0.65175           0.93350  0.94075 0.87200       0.80350</span></span>
<span><span class="co">#&gt; m5.2               0.63450           0.92725  0.93350 0.85800       0.79300</span></span>
<span><span class="co">#&gt; m6.2               0.61325           0.93925  0.94225 0.87875       0.80750</span></span>
<span><span class="co">#&gt; m7.2               0.63050           0.92725  0.93475 0.86150       0.79575</span></span>
<span><span class="co">#&gt; m8.2               0.66675           0.92575  0.94100 0.86975       0.80775</span></span>
<span><span class="co">#&gt; m9.2               0.63175           0.93550  0.94000 0.87125       0.80025</span></span>
<span><span class="co">#&gt; m10.2              0.62600           0.94300  0.95000 0.89425       0.82200</span></span>
<span><span class="co">#&gt; m1.1               0.69950           0.92800  0.94025 0.86900       0.80175</span></span>
<span><span class="co">#&gt; m2.1               0.64700           0.96900  0.97075 0.93775       0.84850</span></span>
<span><span class="co">#&gt; m3.1               0.66175           0.93650  0.94875 0.88900       0.81500</span></span>
<span><span class="co">#&gt; m4.1               0.67400           0.92975  0.94125 0.87275       0.80375</span></span>
<span><span class="co">#&gt; m5.1               0.65700           0.96375  0.97000 0.93425       0.84875</span></span>
<span><span class="co">#&gt; m6.1               0.67125           0.97550  0.97850 0.95450       0.86225</span></span>
<span><span class="co">#&gt; m7.1               0.65200           0.95400  0.95600 0.90875       0.83075</span></span>
<span><span class="co">#&gt; m8.1               0.66675           0.94550  0.95550 0.90275       0.82625</span></span>
<span><span class="co">#&gt; m9.1               0.67600           0.96825  0.97000 0.93550       0.84525</span></span>
<span><span class="co">#&gt; m10.1              0.64775           0.95475  0.96400 0.92300       0.84175</span></span>
<span><span class="co">#&gt;       AccuracyUpper AccuracyNull AccuracyPValue McnemarPValue Positive Negative</span></span>
<span><span class="co">#&gt; m1.2        0.99475       0.6315        0.00000     0.7493333       21    12.25</span></span>
<span><span class="co">#&gt; m2.2        0.99600       0.6180        0.00000     1.0000000       21    13.00</span></span>
<span><span class="co">#&gt; m3.2        0.98950       0.6180        0.00025     0.8700000       21    13.00</span></span>
<span><span class="co">#&gt; m4.2        0.99150       0.6225        0.00000     0.8120000       21    12.75</span></span>
<span><span class="co">#&gt; m5.2        0.98650       0.6270        0.00025     0.7162500       21    12.50</span></span>
<span><span class="co">#&gt; m6.2        0.98975       0.6135        0.00000     0.8700000       21    13.25</span></span>
<span><span class="co">#&gt; m7.2        0.99025       0.6090        0.00000     0.8120000       21    13.50</span></span>
<span><span class="co">#&gt; m8.2        0.98550       0.6225        0.00075     0.6170000       21    12.75</span></span>
<span><span class="co">#&gt; m9.2        0.99150       0.6315        0.00000     0.8700000       21    12.25</span></span>
<span><span class="co">#&gt; m10.2       0.99000       0.6045        0.00000     0.8266667       21    13.75</span></span>
<span><span class="co">#&gt; m1.1        0.98950       0.6315        0.00125     0.7742500       21    12.25</span></span>
<span><span class="co">#&gt; m2.1        0.99775       0.6180        0.00000     1.0000000       21    13.00</span></span>
<span><span class="co">#&gt; m3.1        0.99300       0.6180        0.00075     0.8700000       21    13.00</span></span>
<span><span class="co">#&gt; m4.1        0.99000       0.6225        0.00050     0.8120000       21    12.75</span></span>
<span><span class="co">#&gt; m5.1        0.99500       0.6270        0.00250     1.0000000       21    12.50</span></span>
<span><span class="co">#&gt; m6.1        0.99800       0.6135        0.00125     1.0000000       21    13.25</span></span>
<span><span class="co">#&gt; m7.1        0.99125       0.6090        0.00075     0.8723333       21    13.50</span></span>
<span><span class="co">#&gt; m8.1        0.99325       0.6225        0.00000     0.7493333       21    12.75</span></span>
<span><span class="co">#&gt; m9.1        0.99775       0.6315        0.00525     1.0000000       21    12.25</span></span>
<span><span class="co">#&gt; m10.1       0.99500       0.6045        0.00250     0.8625000       21    13.75</span></span>
<span><span class="co">#&gt;       True Positive False Positive True Negative False Negative      ROCSD</span></span>
<span><span class="co">#&gt; m1.2          21.00           0.25         11.00           1.25 0.03430299</span></span>
<span><span class="co">#&gt; m2.2          20.00           1.00         12.50           0.50 0.02710375</span></span>
<span><span class="co">#&gt; m3.2          20.50           0.50         11.50           1.50 0.04821119</span></span>
<span><span class="co">#&gt; m4.2          20.50           0.75         11.50           1.50 0.01240707</span></span>
<span><span class="co">#&gt; m5.2          20.00           1.00         11.25           1.25 0.06620172</span></span>
<span><span class="co">#&gt; m6.2          20.00           1.00         12.25           1.00 0.05488397</span></span>
<span><span class="co">#&gt; m7.2          20.25           0.75         12.00           1.50 0.01659437</span></span>
<span><span class="co">#&gt; m8.2          20.75           0.25         11.00           1.75 0.01821554</span></span>
<span><span class="co">#&gt; m9.2          20.00           1.00         11.25           1.00 0.03509803</span></span>
<span><span class="co">#&gt; m10.2         20.50           0.50         12.50           1.25 0.05612245</span></span>
<span><span class="co">#&gt; m1.1          20.50           0.75         10.75           3.00 0.05275527</span></span>
<span><span class="co">#&gt; m2.1          20.50           0.75         12.50           1.75 0.03388278</span></span>
<span><span class="co">#&gt; m3.1          20.75           0.50         11.50           2.00 0.04005647</span></span>
<span><span class="co">#&gt; m4.1          20.50           0.75         11.25           2.50 0.07004547</span></span>
<span><span class="co">#&gt; m5.1          20.75           1.50         11.75           2.50 0.02756226</span></span>
<span><span class="co">#&gt; m6.1          20.75           1.00         12.75           3.00 0.03248127</span></span>
<span><span class="co">#&gt; m7.1          20.25           1.00         12.75           2.50 0.02644311</span></span>
<span><span class="co">#&gt; m8.1          20.75           0.25         11.50           1.75 0.04448938</span></span>
<span><span class="co">#&gt; m9.1          20.50           0.75         11.75           2.25 0.03657180</span></span>
<span><span class="co">#&gt; m10.1         21.00           0.75         12.50           2.25 0.08411826</span></span>
<span><span class="co">#&gt;            TSSSD SensitivitySD SpecificitySD Pos Pred ValueSD Neg Pred ValueSD</span></span>
<span><span class="co">#&gt; m1.2  0.09631361    0.02400000    0.09615396       0.05202163      0.041500000</span></span>
<span><span class="co">#&gt; m2.2  0.04441156    0.00000000    0.04445597       0.02771281      0.003464102</span></span>
<span><span class="co">#&gt; m3.2  0.08174327    0.04750000    0.04445597       0.02675818      0.077000000</span></span>
<span><span class="co">#&gt; m4.2  0.08576950    0.04552197    0.09653799       0.05180090      0.073259243</span></span>
<span><span class="co">#&gt; m5.2  0.09351240    0.06741105    0.09653799       0.05172604      0.094422367</span></span>
<span><span class="co">#&gt; m6.2  0.07801281    0.05484828    0.05846580       0.03881044      0.079778861</span></span>
<span><span class="co">#&gt; m7.2  0.04586075    0.02400000    0.06955753       0.03850000      0.037606515</span></span>
<span><span class="co">#&gt; m8.2  0.15176505    0.02400000    0.13065572       0.07102288      0.050000000</span></span>
<span><span class="co">#&gt; m9.2  0.05746839    0.03878466    0.06825137       0.03566861      0.058636593</span></span>
<span><span class="co">#&gt; m10.2 0.10099865    0.04750000    0.06803124       0.04372928      0.071500000</span></span>
<span><span class="co">#&gt; m1.1  0.10254059    0.02771281    0.10049668       0.05577634      0.048833049</span></span>
<span><span class="co">#&gt; m2.1  0.05223260    0.04552197    0.07372189       0.03639139      0.068987922</span></span>
<span><span class="co">#&gt; m3.1  0.12264226    0.04750000    0.08891194       0.04956729      0.083500000</span></span>
<span><span class="co">#&gt; m4.1  0.07407353    0.04750000    0.09792982       0.04825885      0.071500000</span></span>
<span><span class="co">#&gt; m5.1  0.10105261    0.02713546    0.08381328       0.04352011      0.045500000</span></span>
<span><span class="co">#&gt; m6.1  0.08301910    0.03878466    0.05426171       0.03293428      0.068314835</span></span>
<span><span class="co">#&gt; m7.1  0.12655819    0.07150000    0.08878204       0.05502121      0.100000000</span></span>
<span><span class="co">#&gt; m8.1  0.09698425    0.02400000    0.09653799       0.05187485      0.041500000</span></span>
<span><span class="co">#&gt; m9.1  0.18927987    0.04552197    0.16492220       0.08504705      0.094633944</span></span>
<span><span class="co">#&gt; m10.1 0.17836860    0.04552197    0.13402985       0.07695182      0.086183428</span></span>
<span><span class="co">#&gt;       PrecisionSD   RecallSD       F1SD PrevalenceSD Detection RateSD</span></span>
<span><span class="co">#&gt; m1.2   0.05202163 0.02400000 0.02921757    0.0090000       0.01469694</span></span>
<span><span class="co">#&gt; m2.2   0.02771281 0.00000000 0.01385641    0.0000000       0.00000000</span></span>
<span><span class="co">#&gt; m3.2   0.02675818 0.04750000 0.03395585    0.0000000       0.02950000</span></span>
<span><span class="co">#&gt; m4.2   0.05180090 0.04552197 0.02696139    0.0090000       0.02135416</span></span>
<span><span class="co">#&gt; m5.2   0.05172604 0.06741105 0.03717078    0.0103923       0.04714075</span></span>
<span><span class="co">#&gt; m6.2   0.03881044 0.05484828 0.03397425    0.0090000       0.03923009</span></span>
<span><span class="co">#&gt; m7.2   0.03850000 0.02400000 0.00950000    0.0103923       0.01192686</span></span>
<span><span class="co">#&gt; m8.2   0.07102288 0.02400000 0.04783566    0.0090000       0.01989975</span></span>
<span><span class="co">#&gt; m9.2   0.03566861 0.03878466 0.02007486    0.0090000       0.03181588</span></span>
<span><span class="co">#&gt; m10.2  0.04372928 0.04750000 0.04056579    0.0090000       0.03262284</span></span>
<span><span class="co">#&gt; m1.1   0.05577634 0.02771281 0.03182635    0.0090000       0.02368544</span></span>
<span><span class="co">#&gt; m2.1   0.03639139 0.04552197 0.01960230    0.0000000       0.02828869</span></span>
<span><span class="co">#&gt; m3.1   0.04956729 0.04750000 0.04431986    0.0000000       0.02950000</span></span>
<span><span class="co">#&gt; m4.1   0.04825885 0.04750000 0.02724579    0.0090000       0.03388584</span></span>
<span><span class="co">#&gt; m5.1   0.04352011 0.02713546 0.03299874    0.0103923       0.01980530</span></span>
<span><span class="co">#&gt; m6.1   0.03293428 0.03878466 0.03235609    0.0090000       0.02559948</span></span>
<span><span class="co">#&gt; m7.1   0.05502121 0.07150000 0.04692547    0.0103923       0.03942398</span></span>
<span><span class="co">#&gt; m8.1   0.05187485 0.02400000 0.02921757    0.0090000       0.01989975</span></span>
<span><span class="co">#&gt; m9.1   0.08504705 0.04552197 0.05776028    0.0090000       0.02521904</span></span>
<span><span class="co">#&gt; m10.1  0.07695182 0.04552197 0.06271098    0.0090000       0.03295451</span></span>
<span><span class="co">#&gt;       Detection PrevalenceSD Balanced AccuracySD AccuracySD    KappaSD</span></span>
<span><span class="co">#&gt; m1.2              0.03322022          0.04793398 0.03809965 0.08379091</span></span>
<span><span class="co">#&gt; m2.2              0.01732051          0.02193931 0.01732051 0.03695042</span></span>
<span><span class="co">#&gt; m3.2              0.02367840          0.04131586 0.04195533 0.08769407</span></span>
<span><span class="co">#&gt; m4.2              0.05235376          0.04272782 0.03495116 0.07621898</span></span>
<span><span class="co">#&gt; m5.2              0.06501538          0.04652866 0.04389001 0.09040280</span></span>
<span><span class="co">#&gt; m6.2              0.04241364          0.03911841 0.04007805 0.08249596</span></span>
<span><span class="co">#&gt; m7.2              0.03796051          0.02285279 0.01386542 0.03112876</span></span>
<span><span class="co">#&gt; m8.2              0.03652739          0.07599287 0.06341924 0.14058064</span></span>
<span><span class="co">#&gt; m9.2              0.04779383          0.02854820 0.02370654 0.04933812</span></span>
<span><span class="co">#&gt; m10.2             0.03029851          0.05049752 0.04860041 0.10126656</span></span>
<span><span class="co">#&gt; m1.1              0.04311612          0.05103594 0.04149197 0.09034379</span></span>
<span><span class="co">#&gt; m2.1              0.05367805          0.02594867 0.02408838 0.05103838</span></span>
<span><span class="co">#&gt; m3.1              0.02950000          0.06151694 0.05648820 0.12162339</span></span>
<span><span class="co">#&gt; m4.1              0.06231640          0.03691770 0.03377746 0.07203876</span></span>
<span><span class="co">#&gt; m5.1              0.04768648          0.05045377 0.04290299 0.09429873</span></span>
<span><span class="co">#&gt; m6.1              0.01944865          0.04154917 0.04058222 0.08707277</span></span>
<span><span class="co">#&gt; m7.1              0.03840464          0.06326136 0.05893782 0.12565661</span></span>
<span><span class="co">#&gt; m8.1              0.03809090          0.04834942 0.03823175 0.08431044</span></span>
<span><span class="co">#&gt; m9.1              0.04872371          0.09463042 0.07786473 0.17495976</span></span>
<span><span class="co">#&gt; m10.1             0.03598611          0.08913426 0.08061017 0.17467112</span></span>
<span><span class="co">#&gt;       AccuracyLowerSD AccuracyUpperSD AccuracyNullSD AccuracyPValueSD</span></span>
<span><span class="co">#&gt; m1.2       0.05662964     0.009178780      0.0090000     0.0000000000</span></span>
<span><span class="co">#&gt; m2.2       0.02540341     0.003464102      0.0000000     0.0000000000</span></span>
<span><span class="co">#&gt; m3.2       0.05753550     0.015264338      0.0000000     0.0005000000</span></span>
<span><span class="co">#&gt; m4.2       0.05028916     0.010392305      0.0090000     0.0000000000</span></span>
<span><span class="co">#&gt; m5.2       0.05866856     0.015524175      0.0103923     0.0005000000</span></span>
<span><span class="co">#&gt; m6.2       0.05382379     0.014773287      0.0090000     0.0000000000</span></span>
<span><span class="co">#&gt; m7.2       0.01798842     0.005500000      0.0103923     0.0000000000</span></span>
<span><span class="co">#&gt; m8.2       0.08805822     0.023867691      0.0090000     0.0015000000</span></span>
<span><span class="co">#&gt; m9.2       0.03235609     0.007549834      0.0090000     0.0000000000</span></span>
<span><span class="co">#&gt; m10.2      0.07029936     0.014988885      0.0090000     0.0000000000</span></span>
<span><span class="co">#&gt; m1.1       0.05521096     0.015264338      0.0090000     0.0015000000</span></span>
<span><span class="co">#&gt; m2.1       0.03841441     0.006928203      0.0000000     0.0000000000</span></span>
<span><span class="co">#&gt; m3.1       0.07611176     0.023113849      0.0000000     0.0015000000</span></span>
<span><span class="co">#&gt; m4.1       0.04709830     0.012543258      0.0090000     0.0005773503</span></span>
<span><span class="co">#&gt; m5.1       0.06531143     0.013098982      0.0103923     0.0031091264</span></span>
<span><span class="co">#&gt; m6.1       0.05200961     0.019841035      0.0090000     0.0012583057</span></span>
<span><span class="co">#&gt; m7.1       0.07583040     0.027452990      0.0103923     0.0015000000</span></span>
<span><span class="co">#&gt; m8.1       0.05840876     0.008732125      0.0090000     0.0000000000</span></span>
<span><span class="co">#&gt; m9.1       0.10603301     0.031691219      0.0090000     0.0098446263</span></span>
<span><span class="co">#&gt; m10.1      0.10284454     0.039488395      0.0090000     0.0050000000</span></span>
<span><span class="co">#&gt;       McnemarPValueSD PositiveSD NegativeSD True PositiveSD False PositiveSD</span></span>
<span><span class="co">#&gt; m1.2        0.4341674          0  0.5000000       0.5000000        0.5000000</span></span>
<span><span class="co">#&gt; m2.2        0.0000000          0  0.0000000       0.0000000        0.0000000</span></span>
<span><span class="co">#&gt; m3.2        0.2600000          0  0.0000000       1.0000000        1.0000000</span></span>
<span><span class="co">#&gt; m4.2        0.3760000          0  0.5000000       0.9574271        0.9574271</span></span>
<span><span class="co">#&gt; m5.2        0.3606183          0  0.5773503       1.4142136        1.4142136</span></span>
<span><span class="co">#&gt; m6.2        0.2600000          0  0.5000000       1.1547005        1.1547005</span></span>
<span><span class="co">#&gt; m7.2        0.3760000          0  0.5773503       0.5000000        0.5000000</span></span>
<span><span class="co">#&gt; m8.2        0.3361354          0  0.5000000       0.5000000        0.5000000</span></span>
<span><span class="co">#&gt; m9.2        0.2600000          0  0.5000000       0.8164966        0.8164966</span></span>
<span><span class="co">#&gt; m10.2       0.3002221          0  0.5000000       1.0000000        1.0000000</span></span>
<span><span class="co">#&gt; m1.1        0.4422822          0  0.5000000       0.5773503        0.5773503</span></span>
<span><span class="co">#&gt; m2.1        0.3792132          0  0.0000000       0.9574271        0.9574271</span></span>
<span><span class="co">#&gt; m3.1        0.3760000          0  0.0000000       1.0000000        1.0000000</span></span>
<span><span class="co">#&gt; m4.1        0.3760000          0  0.5000000       1.0000000        1.0000000</span></span>
<span><span class="co">#&gt; m5.1        0.2211252          0  0.5773503       0.5773503        0.5773503</span></span>
<span><span class="co">#&gt; m6.1        0.2744534          0  0.5000000       0.8164966        0.8164966</span></span>
<span><span class="co">#&gt; m7.1        0.2211252          0  0.5773503       1.5000000        1.5000000</span></span>
<span><span class="co">#&gt; m8.1        0.4341674          0  0.5000000       0.5000000        0.5000000</span></span>
<span><span class="co">#&gt; m9.1        0.4381488          0  0.5000000       0.9574271        0.9574271</span></span>
<span><span class="co">#&gt; m10.1       0.4341674          0  0.5000000       0.9574271        0.9574271</span></span>
<span><span class="co">#&gt;       True NegativeSD False NegativeSD</span></span>
<span><span class="co">#&gt; m1.2        0.8164966        1.2583057</span></span>
<span><span class="co">#&gt; m2.2        0.5773503        0.5773503</span></span>
<span><span class="co">#&gt; m3.2        0.5773503        0.5773503</span></span>
<span><span class="co">#&gt; m4.2        1.2909944        1.2583057</span></span>
<span><span class="co">#&gt; m5.2        0.9574271        1.2583057</span></span>
<span><span class="co">#&gt; m6.2        0.5000000        0.8164966</span></span>
<span><span class="co">#&gt; m7.2        0.8164966        1.0000000</span></span>
<span><span class="co">#&gt; m8.2        1.6329932        1.7078251</span></span>
<span><span class="co">#&gt; m9.2        0.9574271        0.8164966</span></span>
<span><span class="co">#&gt; m10.2       1.0000000        0.9574271</span></span>
<span><span class="co">#&gt; m1.1        0.9574271        1.2909944</span></span>
<span><span class="co">#&gt; m2.1        0.9574271        0.9574271</span></span>
<span><span class="co">#&gt; m3.1        1.1547005        1.1547005</span></span>
<span><span class="co">#&gt; m4.1        1.2583057        1.2909944</span></span>
<span><span class="co">#&gt; m5.1        1.4142136        1.0000000</span></span>
<span><span class="co">#&gt; m6.1        0.5000000        0.8164966</span></span>
<span><span class="co">#&gt; m7.1        0.9574271        1.2909944</span></span>
<span><span class="co">#&gt; m8.1        1.2909944        1.2583057</span></span>
<span><span class="co">#&gt; m9.1        1.8257419        2.0615528</span></span>
<span><span class="co">#&gt; m10.1       1.7320508        1.8929694</span></span></code></pre></div>
<p>Otherwise, the mean validation metric values per algorithm can also
be obtained with the following code:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/train_sdm.html">mean_validation_metrics</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`Araucaria angustifolia`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 53</span></span></span>
<span><span class="co">#&gt;   algo       ROC   TSS Sensitivity Specificity `Pos Pred Value` `Neg Pred Value`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> kknn     0.966 0.874       0.969       0.906            0.945            0.952</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> naive_b… 0.976 0.905       0.982       0.923            0.955            0.971</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 46 more variables: Precision &lt;dbl&gt;, Recall &lt;dbl&gt;, F1 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Prevalence &lt;dbl&gt;, `Detection Rate` &lt;dbl&gt;, `Detection Prevalence` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Balanced Accuracy` &lt;dbl&gt;, Accuracy &lt;dbl&gt;, Kappa &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AccuracyLower &lt;dbl&gt;, AccuracyUpper &lt;dbl&gt;, AccuracyNull &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AccuracyPValue &lt;dbl&gt;, McnemarPValue &lt;dbl&gt;, Positive &lt;dbl&gt;, Negative &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `True Positive` &lt;dbl&gt;, `False Positive` &lt;dbl&gt;, `True Negative` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `False Negative` &lt;dbl&gt;, ROCSD &lt;dbl&gt;, TSSSD &lt;dbl&gt;, SensitivitySD &lt;dbl&gt;, …</span></span></span></code></pre></div>
<p>After building predictions, it is possible to ensemble GCMs using
<code>gcms_ensembles</code> function and informing in the parameter
<code>gcms</code> which part of <code>scenarios_names(i)</code> should
be used to ensemble gcms. In this example, scenarios names are:
<code>c("ca_ssp245_2090", "ca_ssp585_2090", "mi_ssp245_2090", "mi_ssp585_2090")</code>.
Thus, if we set the parameter to <code>c("ca", "mi")</code> the function
searches through scenarios names for <code>"ca"</code> and
<code>"mi"</code> and remove these parts of scenarios names. What
remains, in the example, is:
<code>c("_ssp245_2090", "_ssp585_2090", "_ssp245_2090", "_ssp585_2090")</code>.
Then, the function ensembles scenarios with the same new names (note
that, by removing the gcms abbreviation, the remaining name repeats
itself two times). At the end, ensembles will be named after the new
names generated in this last step and are included in object
<code>i</code> scenarios.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gcms_ensembles.html">gcms_ensembles</a></span><span class="op">(</span><span class="va">i</span>, gcms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ca"</span>, <span class="st">"mi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `cell_id` -&gt; `cell_id...1`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `mean_occ_prob` -&gt; `mean_occ_prob...2`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `wmean_AUC` -&gt; `wmean_AUC...3`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `committee_avg` -&gt; `committee_avg...4`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `cell_id` -&gt; `cell_id...5`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `mean_occ_prob` -&gt; `mean_occ_prob...6`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `wmean_AUC` -&gt; `wmean_AUC...7`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `committee_avg` -&gt; `committee_avg...8`</span></span>
<span><span class="va">i</span></span>
<span><span class="co">#&gt;             caretSDM           </span></span>
<span><span class="co">#&gt; ...............................</span></span>
<span><span class="co">#&gt; Class                         : input_sdm</span></span>
<span><span class="co">#&gt; --------  Occurrences  --------</span></span>
<span><span class="co">#&gt; Species Names                 : Araucaria angustifolia </span></span>
<span><span class="co">#&gt; Number of presences           : 84 </span></span>
<span><span class="co">#&gt; Pseudoabsence methods         :</span></span>
<span><span class="co">#&gt;     Method to obtain PAs      : bioclim </span></span>
<span><span class="co">#&gt;     Number of PA sets         : 10 </span></span>
<span><span class="co">#&gt;     Number of PAs in each set : 84 </span></span>
<span><span class="co">#&gt; Data Cleaning                 : NAs, Capitals, Centroids, Geographically Duplicated, Identical Lat/Long, Institutions, Invalid, Non-terrestrial, Duplicated Cell (grid) </span></span>
<span><span class="co">#&gt; --------  Predictors  ---------</span></span>
<span><span class="co">#&gt; Number of Predictors          : 6 </span></span>
<span><span class="co">#&gt; Predictors Names              : bio1, bio4, bio12, PC1, PC2, PC3 </span></span>
<span><span class="co">#&gt; PCA-transformed variables     : DONE </span></span>
<span><span class="co">#&gt; Cummulative proportion ( 1 ) : PC1, PC2, PC3 </span></span>
<span><span class="co">#&gt; ---------  Scenarios  ---------</span></span>
<span><span class="co">#&gt; Number of Scenarios           : 5 </span></span>
<span><span class="co">#&gt; Scenarios Names               : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current </span></span>
<span><span class="co">#&gt; -----------  Models  ----------</span></span>
<span><span class="co">#&gt; Algorithms Names              : naive_bayes kknn </span></span>
<span><span class="co">#&gt; Variables Names               : PC1 PC2 PC3 </span></span>
<span><span class="co">#&gt; Model Validation              :</span></span>
<span><span class="co">#&gt;     Method                    : repeatedcv </span></span>
<span><span class="co">#&gt;     Number                    : 4 </span></span>
<span><span class="co">#&gt;     Metrics                   :</span></span>
<span><span class="co">#&gt; $`Araucaria angustifolia`</span></span>
<span><span class="co">#&gt;          algo       ROC       TSS Sensitivity Specificity</span></span>
<span><span class="co">#&gt; 1        kknn 0.9660175 0.8737179     0.96895    0.905850</span></span>
<span><span class="co">#&gt; 2 naive_bayes 0.9759408 0.9047619     0.98205    0.922625</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------  Predictions  --------</span></span>
<span><span class="co">#&gt; Ensembles                     :</span></span>
<span><span class="co">#&gt;     Scenarios                 : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current _ssp245_2090 _ssp585_2090 </span></span>
<span><span class="co">#&gt;     Methods                   : mean_occ_prob wmean_AUC committee_avg </span></span>
<span><span class="co">#&gt; Thresholds                    :</span></span>
<span><span class="co">#&gt;     Method                    : threshold </span></span>
<span><span class="co">#&gt;     Criteria                  : 0.9</span></span></code></pre></div>
<p>Note that now the section “Predictions” has two scenarios called
_ssp245_2090 and _ssp585_2090, which are the GCM’s ensembles that we
have calculated.</p>
</div>
<div class="section level3">
<h3 id="plotting-results">Plotting results<a class="anchor" aria-label="anchor" href="#plotting-results"></a>
</h3>
<p>To plot results, we prepared plot and mapview functions. Here we
present only the plot versions due to mapview limitations for markdown,
but we encourage users to use the mapview alternatives every time it is
possible. To do that, simply alternate the “plot” portion of functions
to “mapview”. As an example, <code>plot_occurrences</code> has its
counterpart function <code>mapview_occurrences</code> with the same set
of arguments an functioning. For plot_predictions, we can set some
parameters to control what is being plotted. Probably the most important
parameter is the <code>scenario</code>, which user can change to plot
every different scenario projected. If you are modeling more than one
species you can inform the correct species to be plotted using the
<code>spp_name</code> parameter and if you are wealling to debate
separate projections you can plot them informing the model
<code>id</code> (see row names of <code>get_validation_metrics</code>
above to retrieve models ids).</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_occurrences.html">plot_predictions</a></span><span class="op">(</span><span class="va">i</span>,</span>
<span>                 spp_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 scenario <span class="op">=</span> <span class="st">"current"</span>,</span>
<span>                 id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 ensemble <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 ensemble_type <span class="op">=</span> <span class="st">"mean_occ_prob"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Araucaria_files/figure-html/plot_current_results-1.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_occurrences.html">plot_predictions</a></span><span class="op">(</span><span class="va">i</span>,</span>
<span>                 spp_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 scenario <span class="op">=</span> <span class="st">"_ssp245_2090"</span>,</span>
<span>                 id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 ensemble <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 ensemble_type <span class="op">=</span> <span class="st">"mean_occ_prob"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Araucaria_files/figure-html/ssp245_2090-1.png" width="700"></p>
<p>Another plot widely used in SDM studies is the Partial Dependence
Plot, which informs the response curves to each variable. Here we are
using PCA axes as predictors, so there is not much sense in plotting
these curves, but if someone want to do that, it is possible through the
<code>pdp_sdm</code> function.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pdp_sdm.html">pdp_sdm</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</span></span></code></pre></div>
<p><img src="Araucaria_files/figure-html/pdp_sdm-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="writing-results">Writing results<a class="anchor" aria-label="anchor" href="#writing-results"></a>
</h3>
<p>To export <code>caretSDM</code> objects and outputs from R you can
use the write functions. For all possibilities see the help file
<code><a href="../reference/write_ensembles.html">?write_ensembles</a></code>. We encourage users to use standard path
configuration, which organizes outputs in a straightforward fashion.
Common functions are the following:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write_ensembles.html">write_occurrences</a></span><span class="op">(</span><span class="va">i</span>, path <span class="op">=</span> <span class="st">"results/occurrences.csv"</span>, grid <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write_ensembles.html">write_pseudoabsences</a></span><span class="op">(</span><span class="va">i</span>, path <span class="op">=</span> <span class="st">"results/pseudoabsences"</span>, ext <span class="op">=</span> <span class="st">".csv"</span>, centroid <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write_ensembles.html">write_grid</a></span><span class="op">(</span><span class="va">i</span>, path <span class="op">=</span> <span class="st">"results/grid_study_area.gpkg"</span>, centroid <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write_ensembles.html">write_ensembles</a></span><span class="op">(</span><span class="va">i</span>, path <span class="op">=</span> <span class="st">"results/ensembles"</span>, ext <span class="op">=</span> <span class="st">".tif"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This vignette demonstrates how to build Species Distribution Models
using <code>caretSDM</code>. This vignette aimed to terrestrial uses
highlights the use of the package using a grid in the sdm_area.
Alternative to that can be seen in vignettes(“Salminus”, “caretSDM”)
where we build SDMs for a fish species using river lines in a
simplefeatures object instead of cells in a grid.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">end_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">end_time</span> <span class="op">-</span> <span class="va">start_time</span></span>
<span><span class="co">#&gt; Time difference of 2.013524 mins</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dayani Bailly, Edivando Couto, José Hilário Delconte Ferreira, Marcos R. Lima, Reginaldo Ré, Valéria Batista, Luíz Fernando Esser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
