<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modeling Species Distributions in Continental Water Bodies • caretSDM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modeling Species Distributions in Continental Water Bodies">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">caretSDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Add-Algorithm.html">Adding New Algorithms to caretSDM</a></li>
    <li><a class="dropdown-item" href="../articles/Araucaria.html">caretSDM Workflow for Species Distribution Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/Compact.html">Concatenate functions in caretSDM</a></li>
    <li><a class="dropdown-item" href="../articles/ESM.html">Modeling Rare Species using Ensemble of Small Models</a></li>
    <li><a class="dropdown-item" href="../articles/InvasiveSpp.html">Projecting Non-native Distribution using SDMs</a></li>
    <li><a class="dropdown-item" href="../articles/Salminus.html">Modeling Species Distributions in Continental Water Bodies</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/luizesser/caretSDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Modeling Species Distributions in Continental Water Bodies</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/luizesser/caretSDM/blob/main/vignettes/articles/Salminus.Rmd" class="external-link"><code>vignettes/articles/Salminus.Rmd</code></a></small>
      <div class="d-none name"><code>Salminus.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>caretSDM</code> is a R package that uses the powerful
<code>caret</code> package as the main engine to obtain Species
Distribution Models. One of its main attributes is the strong
geoprocessing underlying its functions provided by <code>stars</code>
package. Here we show how to model species distributions using
<code>caretSDM</code> through the function <code>sdm_area</code> with
lines as predictor variables. We will also show how to apply a VIF
routine in predictors and scenarios to avoid multicolinearity. The aim
of this modeling will be to obtain the current and future distribution
of <em>Salminus brasiliensis</em>, a key fish species from South
Brazil.</p>
<p>First, we need to open our library.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://luizesser.github.io/caretSDM/">caretSDM</a></span><span class="op">)</span></span>
<span><span class="va">start_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pre-processing">Pre-Processing<a class="anchor" aria-label="anchor" href="#pre-processing"></a>
</h2>
<p>To obtain models, we will need climatic data and species records. To
easily obtain these data, we have two functions:
<code>WorldClim_data</code> function downloads climatic variables from
WorldClim 2.1, a widely used open-source database; in the same way,
<code>GBIF_data</code> function downloads species records from GBIF,
also a widely used open-source database. You can read more about them by
running in the console <code><a href="../reference/GBIF_data.html">?GBIF_data</a></code> and
<code><a href="../reference/WorldClim_data.html">?WorldClim_data</a></code>.</p>
<div class="section level3">
<h3 id="obtaining-species-records">Obtaining species records<a class="anchor" aria-label="anchor" href="#obtaining-species-records"></a>
</h3>
<p>A easy way to get species data using <code>caretSDM</code> is the
function <code>GBIF_data</code>, which retrieves species records from
GBIF. Understandably, there are other sources of species data available,
as well as our own data that can be the result of field work. In this
sense, one can import to R it’s own data in multiple ways, but be sure
that the table must always have three columns: species, decimalLongitude
and decimalLatitude. <code>GBIF_data</code> function can retrieve the
data ready to be included in caretSDM, thus if you have any doubt on how
to format your own data, use <code>GBIF_data</code> function with the
parameter <code>as_df = TRUE</code> to retrieve an example table. As
standard, <code>GBIF_data</code> function sets
<code>as_df = FALSE</code>, which makes the function return a
<code>occurrences</code> object (more about that further below). An
example code for this step would be:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">salm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GBIF_data.html">GBIF_data</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Salminus brasiliensis"</span><span class="op">)</span>, as_df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>But we already have a <code>salm</code> object included in the
package, which is the same output, but with filtered records to match
our study area. Note that coordinates are in a metric CRS (EPSG:
6933).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">salm</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 species decimalLongitude decimalLatitude</span></span>
<span><span class="co">#&gt; 1 Salminus brasiliensis         -5002956        -3034581</span></span>
<span><span class="co">#&gt; 2 Salminus brasiliensis         -5123570        -3049429</span></span>
<span><span class="co">#&gt; 3 Salminus brasiliensis         -5138591        -2830253</span></span>
<span><span class="co">#&gt; 4 Salminus brasiliensis         -5263273        -3143263</span></span>
<span><span class="co">#&gt; 5 Salminus brasiliensis         -5172118        -3156734</span></span>
<span><span class="co">#&gt; 6 Salminus brasiliensis         -5172118        -3156734</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="obtaining-climatic-data">Obtaining climatic data<a class="anchor" aria-label="anchor" href="#obtaining-climatic-data"></a>
</h3>
<p>For climatic data, we will first download and import current data,
which is used to build the models. <code>WorldClim_data</code> function
has an argument to set the directory in which you want to save the
files. If you don’t set it, files will be saved in your working
directory (run <code><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd()</a></code> to find out your working directory)
in the folder “input_data/WorldClim_data_current/”. If period is set to
“future”, then it is saved in “input_data/WorldClim_data_future/”. We
could run this script with a smaller resolution, but as the aim here is
to show how the package works, we will use a resolution of 10
arc-minutes, which is very coarse, but quicker to download and run.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download current bioclimatic variables</span></span>
<span><span class="fu"><a href="../reference/WorldClim_data.html">WorldClim_data</a></span><span class="op">(</span>path <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>               period <span class="op">=</span> <span class="st">"current"</span>, </span>
<span>               variable <span class="op">=</span> <span class="st">"bioc"</span>, </span>
<span>               resolution <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Import current bioclimatic variables to R</span></span>
<span><span class="va">bioc</span> <span class="op">&lt;-</span> <span class="fu">read_stars</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"input_data/WorldClim_data_current/"</span>, full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, along <span class="op">=</span> <span class="st">"band"</span>, normalize_path <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>As in the previous section, we already have a <code>bioc</code>
object included in the package, which is the same output, but masked to
match our study area and with fewer variables.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bioc</span></span>
<span><span class="co">#&gt; stars object with 3 dimensions and 1 attribute</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;              Min.  1st Qu.   Median     Mean 3rd Qu. Max. NA's</span></span>
<span><span class="co">#&gt; current  14.58698 21.19678 298.9147 622.9417  1353.5 2368 1845</span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;      from  to offset   delta refsys point              values x/y</span></span>
<span><span class="co">#&gt; x     747 798   -180  0.1667 WGS 84 FALSE                NULL [x]</span></span>
<span><span class="co">#&gt; y     670 706     90 -0.1667 WGS 84 FALSE                NULL [y]</span></span>
<span><span class="co">#&gt; band    1   3     NA      NA     NA    NA bio1 , bio4 , bio12</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="defining-the-study-area">Defining the study area<a class="anchor" aria-label="anchor" href="#defining-the-study-area"></a>
</h3>
<p>A important step on model building in Species Distribution Models, is
the definition of accessible area (the M in BAM diagram). This area can
be, in Geographical Information Systems terms, as an example, the
delimitation of a habitat (polygon) or a river basin network (lines).
Another broadly used approach is the use of buffers around presences.
The buffer size translates the potential distribution capabilities of a
species. To educational purposes, we will use a simple polygon of Parana
state river network that is available in caretSDM as the
<code>rivs</code> object (see <code><a href="../reference/rivs.html">?rivs</a></code> for more information on
the data)..</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rivs</span></span>
<span><span class="co">#&gt; Simple feature collection with 1031 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: LINESTRING</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -54.61834 ymin: -26.28958 xmax: -48.68542 ymax: -22.53484</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    LENGTH_KM DIST_DN_KM                       geometry</span></span>
<span><span class="co">#&gt; 1       7.31     2189.9 LINESTRING (-53.52234 -22.5...</span></span>
<span><span class="co">#&gt; 2       4.21     2186.2 LINESTRING (-53.05304 -22.5...</span></span>
<span><span class="co">#&gt; 3       2.14     2200.3 LINESTRING (-52.92292 -22.5...</span></span>
<span><span class="co">#&gt; 4       3.45     2186.7 LINESTRING (-53.54792 -22.5...</span></span>
<span><span class="co">#&gt; 5       1.26     2184.9 LINESTRING (-53.07708 -22.5...</span></span>
<span><span class="co">#&gt; 6       3.75     2302.6 LINESTRING (-52.14375 -22.5...</span></span>
<span><span class="co">#&gt; 7       2.12     2202.7 LINESTRING (-52.90625 -22.5...</span></span>
<span><span class="co">#&gt; 8       2.54     2183.9 LINESTRING (-53.55625 -22.5...</span></span>
<span><span class="co">#&gt; 9       4.89     2195.6 LINESTRING (-52.94375 -22.5...</span></span>
<span><span class="co">#&gt; 10     11.24     2320.3 LINESTRING (-51.93542 -22.5...</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rivs</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/tidyverse-methods.html">select_predictors</a></span><span class="op">(</span><span class="va">LENGTH_KM</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Salminus_files/figure-html/rivs_view-1.png" width="700"></p>
<p>The <code>sdm_area</code> function is responsible to create a grid to
build models, a key aspect of caretSDM workflow. With a grid built,
modelers can pass multiple rasters with different resolutions, CRSs and
extents. The package will be responsible to rescale, transform and crop
every raster to match the grid. The grid returned by the
<code>sdm_area</code> function is from <code>sdm_area</code> class, a
class that will also keep the environmental/climatic data (<em>i.e.</em>
“predictor variables”, “covariates”, “explanatory variables”, “features”
or “control variables”). With this class we will perform analysis using
only the predictors. The grid is built using mostly the first three
arguments: (1) a shape from <code>sf</code> class, but rasters from
<code>stars</code>, <code>rasterStack</code> or <code>SpatRaster</code>
class are also allowed; (2) the cell size of the grid; and (3) the
Coordinate Reference System (CRS). Note that the cell size can be metric
or not depending on the CRS informed. It is important to inform a cell
size bigger than the coarser raster that will be used, otherwise
rescaling process may return empty cells. The rescaling can be performed
using GDAL (quicker but less precise) or the <code>stars</code> package
(slower but more precise). The first will address values to cells by
calculating the mean (for continuous variables) or the median (for
categorical variables) of the values falling within the cell. The
approach using <code>stars</code> will do the same thing, but weighting
for the area of each value within the cell. However, as we are using a
river network as study area, <em>i.e.</em> a simple features object with
<code>LINESTRING</code> as geometry types, we can set the argument
<code>lines_as_sdm_area = TRUE</code>. This will chop lines within
<code>rivs</code> (hydrological predictors) given the grid cells built.
In other words, if a segment of line holds a hydrological information,
but crosses between two different cells, it will be splitted in two
different lines both with the same hydrological data, but different
bioclimatic data. The use of <code>lines_as_sdm_area = TRUE</code> takes
more time to run, but is very precise for continental water bodies
modeling. For other arguments meaning see <code><a href="../reference/sdm_area.html">?sdm_area</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sdm_area.html">sdm_area</a></span><span class="op">(</span><span class="va">rivs</span>, </span>
<span>               cell_size <span class="op">=</span> <span class="fl">25000</span>, </span>
<span>               crs <span class="op">=</span> <span class="fl">6933</span>, </span>
<span>               variables_selected <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               gdal <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>               crop_by <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>               lines_as_sdm_area <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Making grid over study area is an expensive task. Please, be patient!</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.4.0; sf_use_s2() is TRUE</span></span>
<span><span class="va">sa</span></span>
<span><span class="co">#&gt;           caretSDM         </span></span>
<span><span class="co">#&gt; ...........................</span></span>
<span><span class="co">#&gt; Class                     : sdm_area</span></span>
<span><span class="co">#&gt; Extent                    : -5269921 -3240236 -4697475 -2803134 (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; CRS                       : EPSG:6933 </span></span>
<span><span class="co">#&gt; Resolution                : (25000, 25000) (x, y)</span></span>
<span><span class="co">#&gt; Number of Predictors      : 2 </span></span>
<span><span class="co">#&gt; Predictors Names          : LENGTH_KM, DIST_DN_KM</span></span></code></pre></div>
<p>Note that the function returned two predictor variables
(<code>Predictor Names</code> above). These “predictors” are actually
columns included in the <code>rivs</code> shape’s data table. One can
filter these variables using <code>select_predictors</code> function,
but we will not do that here, because these variables represent
important predictor variables that will be used to model species
distribution. You can explore the grid generated and stored in the
<code>sdm_area</code> object using the functions
<code><a href="../reference/plot_occurrences.html">mapview_grid()</a></code> or <code><a href="../reference/plot_occurrences.html">plot_grid()</a></code>. Note that the
function used here is the same to plot grids and lines.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_occurrences.html">plot_grid</a></span><span class="op">(</span><span class="va">sa</span><span class="op">)</span></span></code></pre></div>
<p><img src="Salminus_files/figure-html/plot_sdm_area-1.png" width="700"></p>
<p>Now that we have a study area, we can assign predictor variables to
it. To do that, we use the <code>add_predictors</code> function, which
usually will only use the fist two arguments, which are the
<code>sdm_area</code> build in the previous step and the
<code>RasterStack</code>, <code>SpatRaster</code> or <code>stars</code>
object with predictors data. Note that <code>add_predictors</code> also
has a <code>gdal</code> argument, which works as the previous one in
<code>sdm_area</code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_predictors.html">add_predictors</a></span><span class="op">(</span><span class="va">sa</span>, </span>
<span>                     <span class="va">bioc</span>, </span>
<span>                     variables_selected <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                     gdal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Making grid over the study area is an expensive task. Please, be patient!</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span></span>
<span><span class="va">sa</span></span>
<span><span class="co">#&gt;           caretSDM         </span></span>
<span><span class="co">#&gt; ...........................</span></span>
<span><span class="co">#&gt; Class                     : sdm_area</span></span>
<span><span class="co">#&gt; Extent                    : -5269921 -3228134 -4719921 -2803134 (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; CRS                       : EPSG:6933 </span></span>
<span><span class="co">#&gt; Resolution                : (25000, 25000) (x, y)</span></span>
<span><span class="co">#&gt; Number of Predictors      : 5 </span></span>
<span><span class="co">#&gt; Predictors Names          : LENGTH_KM, DIST_DN_KM, bio1, bio4, bio12</span></span></code></pre></div>
<p>Predictors variables are used to train the models. After training the
models, we need to project models into scenarios. Currently, we don’t
have any scenario in our <code>sdm_area</code> object. We can address
the predictors data as the current scenario by applying the function
<code>add_scenario</code> without considering any other argument. This
happens because the argument <code>pred_as_scen</code> is standarly set
to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/add_scenarios.html">add_scenarios</a></span><span class="op">(</span><span class="va">sa</span><span class="op">)</span></span></code></pre></div>
<p>If we are aiming to project species distributions in other scenarios,
we can download data and add in the same way we did for current
data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/WorldClim_data.html">WorldClim_data</a></span><span class="op">(</span>path <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>               period <span class="op">=</span> <span class="st">"future"</span>, </span>
<span>               variable <span class="op">=</span> <span class="st">"bioc"</span>,</span>
<span>               year <span class="op">=</span> <span class="st">"2090"</span>,</span>
<span>               gcm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ca"</span>, <span class="st">"mi"</span><span class="op">)</span>,</span>
<span>               ssp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"245"</span>,<span class="st">"585"</span><span class="op">)</span>,</span>
<span>               resolution <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scen</span> <span class="op">&lt;-</span> <span class="fu">read_stars</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"input_data/WorldClim_data_future/"</span>, full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, along <span class="op">=</span> <span class="st">"band"</span>, normalize_path <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>As with current bioclimatic data, we have already included the
<code>scen</code> object in the package, which is the same output from
above, but masked to match our study area and with fewer variables (see
<code><a href="../reference/scen.html">?scen</a></code> for more information on the data).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scen</span></span>
<span><span class="co">#&gt; stars object with 3 dimensions and 4 attributes</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;                 Min. 1st Qu. Median     Mean  3rd Qu.   Max. NA's</span></span>
<span><span class="co">#&gt; ca_ssp245_2090  18.4  26.100 296.50 570.0926 1188.975 2049.2 1908</span></span>
<span><span class="co">#&gt; ca_ssp585_2090  22.2  31.275 293.25 516.0384 1033.150 1862.2 1908</span></span>
<span><span class="co">#&gt; mi_ssp245_2090  16.3  23.000 314.65 660.9749 1426.800 2414.8 1908</span></span>
<span><span class="co">#&gt; mi_ssp585_2090  17.9  24.500 323.45 702.6153 1534.100 2585.0 1908</span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;      from  to offset   delta refsys point              values x/y</span></span>
<span><span class="co">#&gt; x     747 798   -180  0.1667 WGS 84 FALSE                NULL [x]</span></span>
<span><span class="co">#&gt; y     670 706     90 -0.1667 WGS 84 FALSE                NULL [y]</span></span>
<span><span class="co">#&gt; band    1   3     NA      NA     NA    NA bio1 , bio4 , bio12</span></span></code></pre></div>
<p>Now we can add the current and future scenarios at once in our
<code>sdm_area</code> object. For the meaning on other parameters see
the help file at <code><a href="../reference/add_scenarios.html">?add_scenarios</a></code>. When adding scenarios, the
function will test if all variables are available in all scenarios,
otherwise it will filter predictors. Note that <code>scen</code> does
not have the hydrological variables. These variables are what we call
“stationary” variables, meaning that they don’t change despite climate
change scenarios. For that, we must inform the function which variables
will be replicated between scenarios.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_scenarios.html">add_scenarios</a></span><span class="op">(</span><span class="va">sa</span>, </span>
<span>                    scen <span class="op">=</span> <span class="va">scen</span>, </span>
<span>                    scenarios_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                    pred_as_scen <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    variables_selected <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                    stationary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LENGTH_KM"</span>, <span class="st">"DIST_DN_KM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Making grid over the study area is an expensive task. Please, be patient!</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Making grid over the study area is an expensive task. Please, be patient!</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Making grid over the study area is an expensive task. Please, be patient!</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Making grid over the study area is an expensive task. Please, be patient!</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span></span>
<span><span class="va">sa</span></span>
<span><span class="co">#&gt;           caretSDM         </span></span>
<span><span class="co">#&gt; ...........................</span></span>
<span><span class="co">#&gt; Class                     : sdm_area</span></span>
<span><span class="co">#&gt; Extent                    : -5269921 -3228134 -4719921 -2803134 (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; CRS                       : EPSG:6933 </span></span>
<span><span class="co">#&gt; Resolution                : (25000, 25000) (x, y)</span></span>
<span><span class="co">#&gt; Number of Predictors      : 5 </span></span>
<span><span class="co">#&gt; Predictors Names          : LENGTH_KM, DIST_DN_KM, bio1, bio4, bio12 </span></span>
<span><span class="co">#&gt; Number of Scenarios      : 5 </span></span>
<span><span class="co">#&gt; Scenarios Names          : ca_ssp245_2090, ca_ssp585_2090, mi_ssp245_2090, mi_ssp585_2090, current</span></span></code></pre></div>
<p>It is common that modelers need to subset variables that will inform
models. This can be due to statistical artifacts that are common in
quarter bioclimatic variables, or a causation subset, aiming for those
variables with causality effect on species distribution. The user may
also want to change scenarios names, predictors names or retrieve
predictors data. For that there are a myriad of functions that can be
found in the package, most of them under the help files of the functions
<code><a href="../reference/add_predictors.html">?add_predictors</a></code> and <code><a href="../reference/add_scenarios.html">?add_scenarios</a></code>, but also
<code><a href="../reference/tidyverse-methods.html">?select_predictors</a></code>.</p>
</div>
<div class="section level3">
<h3 id="defining-the-occurrences-set-in-the-study-area">Defining the occurrences set in the study area<a class="anchor" aria-label="anchor" href="#defining-the-occurrences-set-in-the-study-area"></a>
</h3>
<p>As <code>caretSDM</code> has a strong GIS background, it is necessary
to explicitly tell which CRS is your data in. This will assure that
every GIS transformation is correct. <code>occurrences_sdm</code>
function creates a occurrences class (<em>i.e.</em> “response variable”,
“target” or “label”) that will be used in occurrences’ transformations
and functions, as pseudoabsences generation. For a reference, GBIF data
is in crs = 4326, but our records stored in <code>salm</code> object is
transformed to 6933 (see <code><a href="../reference/salm.html">?salm</a></code> for more information on the
data).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/occurrences_sdm.html">occurrences_sdm</a></span><span class="op">(</span><span class="va">salm</span>, crs <span class="op">=</span> <span class="fl">6933</span><span class="op">)</span></span>
<span><span class="va">oc</span></span>
<span><span class="co">#&gt;         caretSDM       </span></span>
<span><span class="co">#&gt; .......................</span></span>
<span><span class="co">#&gt; Class                 : occurrences</span></span>
<span><span class="co">#&gt; Species Names         : Salminus brasiliensis </span></span>
<span><span class="co">#&gt; Number of presences   : 46 </span></span>
<span><span class="co">#&gt; ================================</span></span>
<span><span class="co">#&gt; Data:</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -5263273 ymin: -3156734 xmax: -5002956 ymax: -2830253</span></span>
<span><span class="co">#&gt; Projected CRS: WGS 84 / NSIDC EASE-Grid 2.0 Global</span></span>
<span><span class="co">#&gt;                 species                  geometry</span></span>
<span><span class="co">#&gt; 1 Salminus brasiliensis POINT (-5002956 -3034581)</span></span>
<span><span class="co">#&gt; 2 Salminus brasiliensis POINT (-5123570 -3049429)</span></span>
<span><span class="co">#&gt; 3 Salminus brasiliensis POINT (-5138591 -2830253)</span></span>
<span><span class="co">#&gt; 4 Salminus brasiliensis POINT (-5263273 -3143263)</span></span>
<span><span class="co">#&gt; 5 Salminus brasiliensis POINT (-5172118 -3156734)</span></span>
<span><span class="co">#&gt; 6 Salminus brasiliensis POINT (-5172118 -3156734)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_occurrences.html">plot_occurrences</a></span><span class="op">(</span><span class="va">oc</span><span class="op">)</span></span></code></pre></div>
<p><img src="Salminus_files/figure-html/plot_occurrences-1.png" width="700"></p>
<p>This next step assigns occurrences into a study area, excluding
records outside the study area or with NAs as predictors. When
<code>sdm_area</code> is a grid, it will assign records to each cell.
Here, as a line is being used, it is very unlikely that a record will
fall exactly above a line. The solution presented here is the use of
<code><a href="https://r-spatial.github.io/sf/reference/st_nearest_feature.html" class="external-link">sf::st_nearest_feature</a></code> function, which will address each
species record to its closest river line.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/join_area.html">join_area</a></span><span class="op">(</span><span class="va">oc</span>, <span class="va">sa</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-input_sdm-class">The <code>input_sdm</code> class<a class="anchor" aria-label="anchor" href="#the-input_sdm-class"></a>
</h3>
<p>In <code>caretSDM</code> we use multiple classes to perform our
analysis. Every time we perform a new analysis, objects keep the
information of what we did. Ideally, the workflow will have only one
object throughout it. The <code>input_sdm</code> class is the key class
in the workflow, where every function will orbitate. That class puts
occurrences, predictors, scenarios, models and predictions together to
perform analysis that are only possible when two or more of these
classes are available. First, we create the object by informing the
occurrences and the sdm_area.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/input_sdm.html">input_sdm</a></span><span class="op">(</span><span class="va">oc</span>, <span class="va">sa</span><span class="op">)</span></span>
<span><span class="va">i</span></span>
<span><span class="co">#&gt;             caretSDM           </span></span>
<span><span class="co">#&gt; ...............................</span></span>
<span><span class="co">#&gt; Class                         : input_sdm</span></span>
<span><span class="co">#&gt; --------  Occurrences  --------</span></span>
<span><span class="co">#&gt; Species Names                 : Salminus brasiliensis </span></span>
<span><span class="co">#&gt; Number of presences           : 46 </span></span>
<span><span class="co">#&gt; --------  Predictors  ---------</span></span>
<span><span class="co">#&gt; Number of Predictors          : 5 </span></span>
<span><span class="co">#&gt; Predictors Names              : LENGTH_KM, DIST_DN_KM, bio1, bio4, bio12 </span></span>
<span><span class="co">#&gt; ---------  Scenarios  ---------</span></span>
<span><span class="co">#&gt; Number of Scenarios           : 5 </span></span>
<span><span class="co">#&gt; Scenarios Names               : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-cleaning-routine">Data cleaning routine<a class="anchor" aria-label="anchor" href="#data-cleaning-routine"></a>
</h3>
<p>As the first step in our workflow with the <code>input_sdm</code>
object, we will clean our occurrences data by applying a group of
functions from the package <code>CoordinateCleaner</code>. In this
function, we also provide a way to check for environmental duplicates,
by including a predictors object. This function also checks for records
in the sea if the species is terrestrial, but note that this can be
switched off if the studied species is not terrestrial. The way
<code>caretSDM</code> works, we can always overwrite the main
<code>input_sdm</code> object to update it. The function will return a
new object with all the previous information and the new information
obtained from the <code>data_clean</code> function, note that at the end
of the Data Cleaning information there is the Duplicated Cell method
(here actually a duplicated line). This method is only possible when we
have both the <code>occurrence</code> and <code>predictors</code>
data.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_clean.html">data_clean</a></span><span class="op">(</span><span class="va">i</span>,</span>
<span>                capitals <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                centroids <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                duplicated <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                identical <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                institutions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                invalid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                terrestrial <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cell_ids identified, removing duplicated cell_id.</span></span>
<span><span class="co">#&gt; Testing country capitals</span></span>
<span><span class="co">#&gt; Removed 0 records.</span></span>
<span><span class="co">#&gt; Testing country centroids</span></span>
<span><span class="co">#&gt; Removed 0 records.</span></span>
<span><span class="co">#&gt; Testing duplicates</span></span>
<span><span class="co">#&gt; Removed 0 records.</span></span>
<span><span class="co">#&gt; Testing equal lat/lon</span></span>
<span><span class="co">#&gt; Removed 0 records.</span></span>
<span><span class="co">#&gt; Testing biodiversity institutions</span></span>
<span><span class="co">#&gt; Removed 0 records.</span></span>
<span><span class="co">#&gt; Testing coordinate validity</span></span>
<span><span class="co">#&gt; Removed 0 records.</span></span>
<span><span class="co">#&gt; Testing sea coordinates</span></span>
<span><span class="co">#&gt; Reading <span style="color: #0000BB;">ne_110m_land.zip</span> from naturalearth...</span></span>
<span><span class="co">#&gt; Removed 0 records.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="removing-multicolinearity-from-predictors-data">Removing multicolinearity from predictors’ data<a class="anchor" aria-label="anchor" href="#removing-multicolinearity-from-predictors-data"></a>
</h3>
<p>There are two main methods in the SDM literature to consider
multicolinearity in predictors data. One is the use of PCA-axes, which
in <code>caretSDM</code> is performed using
<code>pca_predictors</code>function. The other is through the Variance
Inflation Factor (VIF), which is performed using
<code>vif_predictors</code> function. There, users are able to perform
variables selection through <code>usdm</code> package. The function is a
wrapper for <code><a href="https://rdrr.io/pkg/usdm/man/vif.html" class="external-link">usdm::vifcor</a></code>, where variables are kept given a
maximum threshold of colinearity. The standard is 0.5.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vif_predictors.html">vif_predictors</a></span><span class="op">(</span><span class="va">i</span>, </span>
<span>                    th <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                    maxobservations <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                    variables_selected <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>To better visualize VIF results, users can run
<code>vif_summary</code> functions, which is very self-explanatory.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vif_predictors.html">vif_summary</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="co">#&gt; 2 variables from the 5 input variables have collinearity problem: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; bio12 bio4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; After excluding the collinear variables, the linear correlation coefficients ranges between: </span></span>
<span><span class="co">#&gt; min correlation ( DIST_DN_KM ~ LENGTH_KM ):  -0.03408993 </span></span>
<span><span class="co">#&gt; max correlation ( bio1 ~ DIST_DN_KM ):  -0.2953415 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---------- VIFs of the remained variables -------- </span></span>
<span><span class="co">#&gt;    Variables      VIF</span></span>
<span><span class="co">#&gt; 1  LENGTH_KM 1.006302</span></span>
<span><span class="co">#&gt; 2 DIST_DN_KM 1.095707</span></span>
<span><span class="co">#&gt; 3       bio1 1.101186</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="obtaining-pseudoabsence-data">Obtaining pseudoabsence data<a class="anchor" aria-label="anchor" href="#obtaining-pseudoabsence-data"></a>
</h3>
<p>Pseudoabsence data will be stored in the <code>occurrences</code>
object (inside the <code>input_sdm</code>). To generate them, you must
inform some parameters. Probably one of the most important arguments in
this function is the <code>method</code>. Currently, two methods are
implemented: a “random”, which takes random grid cells (or lines) as
pseudoabsences; and a “bioclim” method, which creates a Surface Range
Envelope (SRE) using presence records, binarizes the projection of the
SRE using the <code>th</code> threshold and then retrieves
pseudoabsences outside the envelope. The number of pseudoabsences
created can be changed using the <code>n_pa</code> parameter. When set
to NULL, <code>n_pa</code> will be equal the number of occurrences (to
avoid imbalance issues). The number of sets of pseudoabsences is
adjusted with the <code>n_set</code> parameter in the function. The
argument <code>variables_selected</code> will inform which variables you
want to use to build your pseudoabsences/models. This can either be a
vector of variables names or a previously performed selection
method.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pseudoabsences.html">pseudoabsences</a></span><span class="op">(</span><span class="va">i</span>, </span>
<span>                    method <span class="op">=</span> <span class="st">"bioclim"</span>, </span>
<span>                    n_set <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                    n_pa <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                    variables_selected <span class="op">=</span> <span class="st">"vif"</span>,</span>
<span>                    th <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> </span>
<span><span class="va">i</span></span>
<span><span class="co">#&gt;             caretSDM           </span></span>
<span><span class="co">#&gt; ...............................</span></span>
<span><span class="co">#&gt; Class                         : input_sdm</span></span>
<span><span class="co">#&gt; --------  Occurrences  --------</span></span>
<span><span class="co">#&gt; Species Names                 : Salminus brasiliensis </span></span>
<span><span class="co">#&gt; Number of presences           : 22 </span></span>
<span><span class="co">#&gt; Pseudoabsence methods         :</span></span>
<span><span class="co">#&gt;     Method to obtain PAs      : bioclim </span></span>
<span><span class="co">#&gt;     Number of PA sets         : 10 </span></span>
<span><span class="co">#&gt;     Number of PAs in each set : 22 </span></span>
<span><span class="co">#&gt; Data Cleaning                 : NAs, Capitals, Centroids, Geographically Duplicated, Identical Lat/Long, Institutions, Invalid, Non-terrestrial, Duplicated Cell (grid) </span></span>
<span><span class="co">#&gt; --------  Predictors  ---------</span></span>
<span><span class="co">#&gt; Number of Predictors          : 5 </span></span>
<span><span class="co">#&gt; Predictors Names              : LENGTH_KM, DIST_DN_KM, bio1, bio4, bio12 </span></span>
<span><span class="co">#&gt; Area (VIF)                    : all</span></span>
<span><span class="co">#&gt; Threshold                     : 0.5</span></span>
<span><span class="co">#&gt; Selected Variables (VIF)      : LENGTH_KM, DIST_DN_KM, bio1 </span></span>
<span><span class="co">#&gt; ---------  Scenarios  ---------</span></span>
<span><span class="co">#&gt; Number of Scenarios           : 5 </span></span>
<span><span class="co">#&gt; Scenarios Names               : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="processing">Processing<a class="anchor" aria-label="anchor" href="#processing"></a>
</h2>
<div class="section level3">
<h3 id="modeling-species-relationship-with-variables">Modeling species relationship with variables<a class="anchor" aria-label="anchor" href="#modeling-species-relationship-with-variables"></a>
</h3>
<p>With the occurrences and predictors data put together, we can pass to
the modeling. As the name suggests, <code>caretSDM</code> uses the
<code>caret</code> package underlying its modeling procedure. For those
who are not familiar, <code>caret</code> is the easiest way to perform
Machine Learning analysis in R. It works by setting a modeling wrapper
to pass multiple packages and can provide a lot of automation regarding
algorithms fine-tuning, data spliting, pre-processing methods and
predictions. These automated functions from <code>caret</code> can be
altered using the <code>ctrl</code> argument in <code>train_sdm</code>
function. See <code><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">?caret::trainControl</a></code> for all options
available.</p>
<p>We show here how to use a repeated crossvalidation method, which is
defined through <code><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">caret::trainControl</a></code>.</p>
<p>Note that, when you are using an algorithm for the first time, caret
will ask you to install the relevant packages to properly run the
algorithm.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ctrl_sdm</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">trainControl</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"repeatedcv"</span>, </span>
<span>                                number <span class="op">=</span> <span class="fl">4</span>, </span>
<span>                                repeats <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                classProbs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                returnResamp <span class="op">=</span> <span class="st">"all"</span>, </span>
<span>                                summaryFunction <span class="op">=</span> <span class="va">summary_sdm</span>, </span>
<span>                                savePredictions <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train_sdm.html">train_sdm</a></span><span class="op">(</span><span class="va">i</span>, </span>
<span>               algo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"naive_bayes"</span>, <span class="st">"kknn"</span><span class="op">)</span>, </span>
<span>               variables_selected <span class="op">=</span> <span class="st">"vif"</span>, </span>
<span>               ctrl<span class="op">=</span><span class="va">ctrl_sdm</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: lattice</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'caret'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:caretSDM':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     predictors</span></span>
<span><span class="va">i</span></span>
<span><span class="co">#&gt;             caretSDM           </span></span>
<span><span class="co">#&gt; ...............................</span></span>
<span><span class="co">#&gt; Class                         : input_sdm</span></span>
<span><span class="co">#&gt; --------  Occurrences  --------</span></span>
<span><span class="co">#&gt; Species Names                 : Salminus brasiliensis </span></span>
<span><span class="co">#&gt; Number of presences           : 22 </span></span>
<span><span class="co">#&gt; Pseudoabsence methods         :</span></span>
<span><span class="co">#&gt;     Method to obtain PAs      : bioclim </span></span>
<span><span class="co">#&gt;     Number of PA sets         : 10 </span></span>
<span><span class="co">#&gt;     Number of PAs in each set : 22 </span></span>
<span><span class="co">#&gt; Data Cleaning                 : NAs, Capitals, Centroids, Geographically Duplicated, Identical Lat/Long, Institutions, Invalid, Non-terrestrial, Duplicated Cell (grid) </span></span>
<span><span class="co">#&gt; --------  Predictors  ---------</span></span>
<span><span class="co">#&gt; Number of Predictors          : 5 </span></span>
<span><span class="co">#&gt; Predictors Names              : LENGTH_KM, DIST_DN_KM, bio1, bio4, bio12 </span></span>
<span><span class="co">#&gt; Area (VIF)                    : all</span></span>
<span><span class="co">#&gt; Threshold                     : 0.5</span></span>
<span><span class="co">#&gt; Selected Variables (VIF)      : LENGTH_KM, DIST_DN_KM, bio1 </span></span>
<span><span class="co">#&gt; ---------  Scenarios  ---------</span></span>
<span><span class="co">#&gt; Number of Scenarios           : 5 </span></span>
<span><span class="co">#&gt; Scenarios Names               : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current </span></span>
<span><span class="co">#&gt; -----------  Models  ----------</span></span>
<span><span class="co">#&gt; Algorithms Names              : naive_bayes kknn </span></span>
<span><span class="co">#&gt; Variables Names               : LENGTH_KM DIST_DN_KM bio1 </span></span>
<span><span class="co">#&gt; Model Validation              :</span></span>
<span><span class="co">#&gt;     Method                    : repeatedcv </span></span>
<span><span class="co">#&gt;     Number                    : 4 </span></span>
<span><span class="co">#&gt;     Metrics                   :</span></span>
<span><span class="co">#&gt; $`Salminus brasiliensis`</span></span>
<span><span class="co">#&gt;          algo       ROC       TSS Sensitivity Specificity</span></span>
<span><span class="co">#&gt; 1        kknn 0.7793611 0.4883333       0.755      0.7425</span></span>
<span><span class="co">#&gt; 2 naive_bayes 0.7883889 0.4408333       0.745      0.7142</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="post-processing">Post-Processing<a class="anchor" aria-label="anchor" href="#post-processing"></a>
</h2>
<div class="section level3">
<h3 id="predicting-species-distribution-in-given-scenarios">Predicting species distribution in given scenarios<a class="anchor" aria-label="anchor" href="#predicting-species-distribution-in-given-scenarios"></a>
</h3>
<p>Now that we have our models, we can make predictions in new
scenarios. The function <code>predict_sdm</code> incorporates also the
prediction of ensembles (<code>ensembles=TRUE</code> is standard). The
function will only predict models that passes a given validation
threshold. This validation metric is set using <code>metric</code> and
<code>th</code> arguments. In the following example, metric is set to be
“ROC” and th is equal 0.9. This means that only models with ROC &gt; 0.9
will be used in predictions and ensembles.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_sdm.html">predict_sdm</a></span><span class="op">(</span><span class="va">i</span>,</span>
<span>                 metric <span class="op">=</span> <span class="st">"ROC"</span>,</span>
<span>                 th <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>                 tp <span class="op">=</span> <span class="st">"prob"</span>,</span>
<span>                 ensembles <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Projecting: 1/5"</span></span>
<span><span class="co">#&gt; [1] "Projecting: 2/5"</span></span>
<span><span class="co">#&gt; [1] "Projecting: 3/5"</span></span>
<span><span class="co">#&gt; [1] "Projecting: 4/5"</span></span>
<span><span class="co">#&gt; [1] "Projecting: 5/5"</span></span>
<span><span class="co">#&gt; [1] "Ensembling..."</span></span>
<span><span class="co">#&gt; [1] "ca_ssp245_2090"</span></span>
<span><span class="co">#&gt; [1] "Salminus brasiliensis"</span></span>
<span><span class="co">#&gt; [1] "ca_ssp585_2090"</span></span>
<span><span class="co">#&gt; [1] "Salminus brasiliensis"</span></span>
<span><span class="co">#&gt; [1] "mi_ssp245_2090"</span></span>
<span><span class="co">#&gt; [1] "Salminus brasiliensis"</span></span>
<span><span class="co">#&gt; [1] "mi_ssp585_2090"</span></span>
<span><span class="co">#&gt; [1] "Salminus brasiliensis"</span></span>
<span><span class="co">#&gt; [1] "current"</span></span>
<span><span class="co">#&gt; [1] "Salminus brasiliensis"</span></span>
<span><span class="va">i</span></span>
<span><span class="co">#&gt;             caretSDM           </span></span>
<span><span class="co">#&gt; ...............................</span></span>
<span><span class="co">#&gt; Class                         : input_sdm</span></span>
<span><span class="co">#&gt; --------  Occurrences  --------</span></span>
<span><span class="co">#&gt; Species Names                 : Salminus brasiliensis </span></span>
<span><span class="co">#&gt; Number of presences           : 22 </span></span>
<span><span class="co">#&gt; Pseudoabsence methods         :</span></span>
<span><span class="co">#&gt;     Method to obtain PAs      : bioclim </span></span>
<span><span class="co">#&gt;     Number of PA sets         : 10 </span></span>
<span><span class="co">#&gt;     Number of PAs in each set : 22 </span></span>
<span><span class="co">#&gt; Data Cleaning                 : NAs, Capitals, Centroids, Geographically Duplicated, Identical Lat/Long, Institutions, Invalid, Non-terrestrial, Duplicated Cell (grid) </span></span>
<span><span class="co">#&gt; --------  Predictors  ---------</span></span>
<span><span class="co">#&gt; Number of Predictors          : 5 </span></span>
<span><span class="co">#&gt; Predictors Names              : LENGTH_KM, DIST_DN_KM, bio1, bio4, bio12 </span></span>
<span><span class="co">#&gt; Area (VIF)                    : all</span></span>
<span><span class="co">#&gt; Threshold                     : 0.5</span></span>
<span><span class="co">#&gt; Selected Variables (VIF)      : LENGTH_KM, DIST_DN_KM, bio1 </span></span>
<span><span class="co">#&gt; ---------  Scenarios  ---------</span></span>
<span><span class="co">#&gt; Number of Scenarios           : 5 </span></span>
<span><span class="co">#&gt; Scenarios Names               : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current </span></span>
<span><span class="co">#&gt; -----------  Models  ----------</span></span>
<span><span class="co">#&gt; Algorithms Names              : naive_bayes kknn </span></span>
<span><span class="co">#&gt; Variables Names               : LENGTH_KM DIST_DN_KM bio1 </span></span>
<span><span class="co">#&gt; Model Validation              :</span></span>
<span><span class="co">#&gt;     Method                    : repeatedcv </span></span>
<span><span class="co">#&gt;     Number                    : 4 </span></span>
<span><span class="co">#&gt;     Metrics                   :</span></span>
<span><span class="co">#&gt; $`Salminus brasiliensis`</span></span>
<span><span class="co">#&gt;          algo       ROC       TSS Sensitivity Specificity</span></span>
<span><span class="co">#&gt; 1        kknn 0.7793611 0.4883333       0.755      0.7425</span></span>
<span><span class="co">#&gt; 2 naive_bayes 0.7883889 0.4408333       0.745      0.7142</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------  Predictions  --------</span></span>
<span><span class="co">#&gt; Ensembles                     :</span></span>
<span><span class="co">#&gt;     Scenarios                 : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current </span></span>
<span><span class="co">#&gt;     Methods                   : mean_occ_prob wmean_AUC committee_avg </span></span>
<span><span class="co">#&gt; Thresholds                    :</span></span>
<span><span class="co">#&gt;     Method                    : threshold </span></span>
<span><span class="co">#&gt;     Criteria                  : 0.7</span></span></code></pre></div>
<p>In the above print, it is possible to see the “Methods” under the
“Predictions” section, which informs which ensemble types were made:
mean occurrence probability (<code>mean_occ_prob</code>; a simple mean
between GCMs), mean occurrence probability weighted by AUC/ROC
(<code>wmean_AUC</code>; AUC/ROC values are used as weights), and the
majority rule, or the committee average (<code>committee_avg</code>; the
sum of binaries).</p>
<p>Besides the AUC/ROC metric, users can get every available metric by
model using the following code before commit to “ROC”:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/train_sdm.html">get_validation_metrics</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`Salminus brasiliensis`</span></span>
<span><span class="co">#&gt;              algo       ROC       TSS Sensitivity Specificity Pos Pred Value</span></span>
<span><span class="co">#&gt; m1.2         kknn 0.7963889 0.5833333     0.86650     0.71650        0.76525</span></span>
<span><span class="co">#&gt; m2.2         kknn 0.7225000 0.2916667     0.68325     0.60850        0.63625</span></span>
<span><span class="co">#&gt; m3.2         kknn 0.7616667 0.3500000     0.66675     0.68325        0.69650</span></span>
<span><span class="co">#&gt; m4.2         kknn 0.9250000 0.7666667     0.90825     0.85825        0.88750</span></span>
<span><span class="co">#&gt; m5.2         kknn 0.7225000 0.3500000     0.69175     0.70000        0.70825</span></span>
<span><span class="co">#&gt; m6.2         kknn 0.7584722 0.5666667     0.77500     0.79175        0.83350</span></span>
<span><span class="co">#&gt; m7.2         kknn 0.7933333 0.5166667     0.69175     0.82500        0.81250</span></span>
<span><span class="co">#&gt; m8.2         kknn 0.7305556 0.5500000     0.86675     0.68325        0.78175</span></span>
<span><span class="co">#&gt; m9.2         kknn 0.8325000 0.4416667     0.71675     0.77500        0.78750</span></span>
<span><span class="co">#&gt; m10.2        kknn 0.7506944 0.4666667     0.68325     0.78350        0.77375</span></span>
<span><span class="co">#&gt; m1.1  naive_bayes 0.8022222 0.5250000     0.80825     0.71675        0.75875</span></span>
<span><span class="co">#&gt; m2.1  naive_bayes 0.8466667 0.5000000     0.78325     0.77500        0.74150</span></span>
<span><span class="co">#&gt; m3.1  naive_bayes 0.7086111 0.4000000     0.67500     0.72500        0.71250</span></span>
<span><span class="co">#&gt; m4.1  naive_bayes 0.9083333 0.6000000     0.82500     0.77500        0.77675</span></span>
<span><span class="co">#&gt; m5.1  naive_bayes 0.7591667 0.3750000     0.73350     0.64175        0.67625</span></span>
<span><span class="co">#&gt; m6.1  naive_bayes 0.7925000 0.4583333     0.81675     0.69175        0.70100</span></span>
<span><span class="co">#&gt; m7.1  naive_bayes 0.7469444 0.3166667     0.63325     0.68350        0.66350</span></span>
<span><span class="co">#&gt; m8.1  naive_bayes 0.7750000 0.4583333     0.72500     0.73325        0.73850</span></span>
<span><span class="co">#&gt; m9.1  naive_bayes 0.7300000 0.2750000     0.67500     0.67500        0.65000</span></span>
<span><span class="co">#&gt; m10.1 naive_bayes 0.8144444 0.5000000     0.77500     0.72500        0.74175</span></span>
<span><span class="co">#&gt;       Neg Pred Value Precision  Recall      F1 Prevalence Detection Rate</span></span>
<span><span class="co">#&gt; m1.2         0.85400   0.76525 0.86650 0.80875        0.5        0.43400</span></span>
<span><span class="co">#&gt; m2.2         0.76775   0.63625 0.68325 0.62875        0.5        0.34175</span></span>
<span><span class="co">#&gt; m3.2         0.68750   0.69650 0.66675 0.66675        0.5        0.33775</span></span>
<span><span class="co">#&gt; m4.2         0.91650   0.88750 0.90825 0.89150        0.5        0.45475</span></span>
<span><span class="co">#&gt; m5.2         0.68125   0.70825 0.69175 0.67275        0.5        0.34475</span></span>
<span><span class="co">#&gt; m6.2         0.81450   0.83350 0.77500 0.77075        0.5        0.38425</span></span>
<span><span class="co">#&gt; m7.2         0.73975   0.81250 0.69175 0.72750        0.5        0.34025</span></span>
<span><span class="co">#&gt; m8.2         0.85425   0.78175 0.86675 0.79525        0.5        0.43325</span></span>
<span><span class="co">#&gt; m9.2         0.75150   0.78750 0.71675 0.69125        0.5        0.35825</span></span>
<span><span class="co">#&gt; m10.2        0.74900   0.77375 0.68325 0.69225        0.5        0.33625</span></span>
<span><span class="co">#&gt; m1.1         0.78350   0.75875 0.80825 0.77575        0.5        0.40425</span></span>
<span><span class="co">#&gt; m2.1         0.78025   0.74150 0.78325 0.73850        0.5        0.39225</span></span>
<span><span class="co">#&gt; m3.1         0.72025   0.71250 0.67500 0.68400        0.5        0.33650</span></span>
<span><span class="co">#&gt; m4.1         0.85100   0.77675 0.82500 0.78975        0.5        0.40925</span></span>
<span><span class="co">#&gt; m5.1         0.70850   0.67625 0.73350 0.69700        0.5        0.36525</span></span>
<span><span class="co">#&gt; m6.1         0.80425   0.70100 0.81675 0.74775        0.5        0.41050</span></span>
<span><span class="co">#&gt; m7.1         0.68450   0.66350 0.63325 0.63600        0.5        0.31350</span></span>
<span><span class="co">#&gt; m8.1         0.73275   0.73850 0.72500 0.72350        0.5        0.36400</span></span>
<span><span class="co">#&gt; m9.1         0.62500   0.65000 0.67500 0.65525        0.5        0.34025</span></span>
<span><span class="co">#&gt; m10.1        0.76600   0.74175 0.77500 0.75350        0.5        0.38800</span></span>
<span><span class="co">#&gt;       Detection Prevalence Balanced Accuracy Accuracy   Kappa AccuracyLower</span></span>
<span><span class="co">#&gt; m1.2               0.57275           0.79175  0.79450 0.58525       0.45800</span></span>
<span><span class="co">#&gt; m2.2               0.53750           0.64575  0.64575 0.29175       0.32625</span></span>
<span><span class="co">#&gt; m3.2               0.50125           0.67500  0.67425 0.35400       0.36425</span></span>
<span><span class="co">#&gt; m4.2               0.54550           0.88350  0.88625 0.76850       0.56650</span></span>
<span><span class="co">#&gt; m5.2               0.52300           0.67500  0.66625 0.34450       0.34725</span></span>
<span><span class="co">#&gt; m6.2               0.49200           0.78325  0.77600 0.55875       0.44075</span></span>
<span><span class="co">#&gt; m7.2               0.42950           0.75850  0.75075 0.50725       0.41850</span></span>
<span><span class="co">#&gt; m8.2               0.59900           0.77500  0.76725 0.54475       0.45025</span></span>
<span><span class="co">#&gt; m9.2               0.51675           0.72075  0.72075 0.44175       0.38850</span></span>
<span><span class="co">#&gt; m10.2              0.44800           0.73325  0.72375 0.45525       0.39050</span></span>
<span><span class="co">#&gt; m1.1               0.54575           0.76250  0.76250 0.52500       0.44325</span></span>
<span><span class="co">#&gt; m2.1               0.54950           0.75000  0.75325 0.50025       0.42475</span></span>
<span><span class="co">#&gt; m3.1               0.53500           0.70000  0.70125 0.40150       0.37200</span></span>
<span><span class="co">#&gt; m4.1               0.54550           0.80000  0.79525 0.59575       0.46800</span></span>
<span><span class="co">#&gt; m5.1               0.55200           0.68750  0.68250 0.37050       0.34875</span></span>
<span><span class="co">#&gt; m6.1               0.59075           0.72925  0.73025 0.46100       0.39575</span></span>
<span><span class="co">#&gt; m7.1               0.47500           0.65825  0.65125 0.31175       0.32975</span></span>
<span><span class="co">#&gt; m8.1               0.50000           0.72925  0.72700 0.45575       0.39250</span></span>
<span><span class="co">#&gt; m9.1               0.54775           0.63775  0.63425 0.27200       0.32250</span></span>
<span><span class="co">#&gt; m10.1              0.52675           0.75000  0.74875 0.49800       0.41200</span></span>
<span><span class="co">#&gt;       AccuracyUpper AccuracyNull AccuracyPValue McnemarPValue Positive Negative</span></span>
<span><span class="co">#&gt; m1.2        0.96775       0.5225        0.07950     0.8700000      5.5      5.5</span></span>
<span><span class="co">#&gt; m2.2        0.87800       0.5000        0.34700     0.5935000      5.5      5.5</span></span>
<span><span class="co">#&gt; m3.2        0.88900       0.5225        0.41200     0.7907500      5.5      5.5</span></span>
<span><span class="co">#&gt; m4.2        0.98800       0.5450        0.07950     0.8700000      5.5      5.5</span></span>
<span><span class="co">#&gt; m5.2        0.88775       0.5225        0.34975     0.8120000      5.5      5.5</span></span>
<span><span class="co">#&gt; m6.2        0.95550       0.5225        0.11250     0.6240000      5.5      5.5</span></span>
<span><span class="co">#&gt; m7.2        0.94300       0.5225        0.14050     0.8120000      5.5      5.5</span></span>
<span><span class="co">#&gt; m8.2        0.93700       0.5225        0.30250     0.6535000      5.5      5.5</span></span>
<span><span class="co">#&gt; m9.2        0.93375       0.5000        0.17375     0.6820000      5.5      5.5</span></span>
<span><span class="co">#&gt; m10.2       0.93500       0.5225        0.17350     0.5862500      5.5      5.5</span></span>
<span><span class="co">#&gt; m1.1        0.93900       0.5000        0.24725     0.8723333      5.5      5.5</span></span>
<span><span class="co">#&gt; m2.1        0.93800       0.5225        0.21100     1.0000000      5.5      5.5</span></span>
<span><span class="co">#&gt; m3.1        0.92125       0.5225        0.36275     0.8700000      5.5      5.5</span></span>
<span><span class="co">#&gt; m4.1        0.95675       0.5450        0.16050     0.9042500      5.5      5.5</span></span>
<span><span class="co">#&gt; m5.1        0.91625       0.5225        0.36200     0.9042500      5.5      5.5</span></span>
<span><span class="co">#&gt; m6.1        0.93600       0.5225        0.22200     1.0000000      5.5      5.5</span></span>
<span><span class="co">#&gt; m7.1        0.89350       0.5225        0.35300     0.8085000      5.5      5.5</span></span>
<span><span class="co">#&gt; m8.1        0.93700       0.5450        0.61125     0.9042500      5.5      5.5</span></span>
<span><span class="co">#&gt; m9.1        0.88225       0.5225        0.41200     0.9207500      5.5      5.5</span></span>
<span><span class="co">#&gt; m10.1       0.94875       0.5225        0.20325     1.0000000      5.5      5.5</span></span>
<span><span class="co">#&gt;       True Positive False Positive True Negative False Negative      ROCSD</span></span>
<span><span class="co">#&gt; m1.2           4.75           0.75          4.00           1.50 0.07116534</span></span>
<span><span class="co">#&gt; m2.2           3.75           1.75          3.25           2.25 0.20006249</span></span>
<span><span class="co">#&gt; m3.2           3.75           2.25          3.75           1.75 0.23779076</span></span>
<span><span class="co">#&gt; m4.2           5.00           0.75          4.75           1.25 0.08164966</span></span>
<span><span class="co">#&gt; m5.2           3.75           2.00          3.75           2.00 0.21439622</span></span>
<span><span class="co">#&gt; m6.2           4.25           1.25          4.25           1.25 0.04544108</span></span>
<span><span class="co">#&gt; m7.2           3.75           1.75          4.50           1.00 0.16775202</span></span>
<span><span class="co">#&gt; m8.2           4.75           1.50          3.75           2.00 0.26016377</span></span>
<span><span class="co">#&gt; m9.2           4.00           1.75          4.25           1.75 0.08258974</span></span>
<span><span class="co">#&gt; m10.2          3.75           1.75          4.25           1.25 0.10687227</span></span>
<span><span class="co">#&gt; m1.1           4.50           1.50          4.00           1.50 0.20516780</span></span>
<span><span class="co">#&gt; m2.1           4.25           1.50          4.25           1.75 0.13210546</span></span>
<span><span class="co">#&gt; m3.1           3.75           1.75          4.00           2.25 0.19277137</span></span>
<span><span class="co">#&gt; m4.1           4.50           1.00          4.25           1.50 0.11344765</span></span>
<span><span class="co">#&gt; m5.1           4.00           1.75          3.50           2.25 0.05862625</span></span>
<span><span class="co">#&gt; m6.1           4.50           1.50          3.75           2.00 0.13881776</span></span>
<span><span class="co">#&gt; m7.1           3.50           2.00          3.75           1.75 0.16109291</span></span>
<span><span class="co">#&gt; m8.1           4.00           2.50          4.00           2.50 0.14240006</span></span>
<span><span class="co">#&gt; m9.1           3.75           2.25          3.75           2.25 0.23427390</span></span>
<span><span class="co">#&gt; m10.1          4.25           1.50          4.00           1.75 0.10655086</span></span>
<span><span class="co">#&gt;           TSSSD SensitivitySD SpecificitySD Pos Pred ValueSD Neg Pred ValueSD</span></span>
<span><span class="co">#&gt; m1.2  0.1036375    0.09034932     0.1345226       0.06069253       0.10490313</span></span>
<span><span class="co">#&gt; m2.2  0.3500000    0.36677275     0.3009369       0.14893707       0.26974108</span></span>
<span><span class="co">#&gt; m3.2  0.4467993    0.30009262     0.2849367       0.27570576       0.23935678</span></span>
<span><span class="co">#&gt; m4.2  0.1865873    0.10679693     0.1893117       0.14155888       0.09641749</span></span>
<span><span class="co">#&gt; m5.2  0.3919325    0.26300618     0.2987288       0.26728636       0.21925537</span></span>
<span><span class="co">#&gt; m6.2  0.1563472    0.20615528     0.2499445       0.19225764       0.15370209</span></span>
<span><span class="co">#&gt; m7.2  0.2219443    0.21665391     0.1369647       0.14218884       0.17462603</span></span>
<span><span class="co">#&gt; m8.2  0.3584948    0.18045221     0.3667727       0.25208778       0.20830006</span></span>
<span><span class="co">#&gt; m9.2  0.1950783    0.25163913     0.2808124       0.18580366       0.18347638</span></span>
<span><span class="co">#&gt; m10.2 0.1943651    0.28081236     0.1573626       0.15245190       0.19378854</span></span>
<span><span class="co">#&gt; m1.1  0.4163332    0.22173558     0.2629428       0.20830006       0.21347814</span></span>
<span><span class="co">#&gt; m2.1  0.3138766    0.25578507     0.1423807       0.16174981       0.17937925</span></span>
<span><span class="co">#&gt; m3.1  0.2788867    0.27537853     0.1772162       0.08350000       0.26231708</span></span>
<span><span class="co">#&gt; m4.1  0.2596294    0.23629078     0.1562762       0.09885680       0.20423087</span></span>
<span><span class="co">#&gt; m5.1  0.2125681    0.24494897     0.1964502       0.11368377       0.20359334</span></span>
<span><span class="co">#&gt; m6.1  0.2349153    0.13731563     0.1423807       0.13456845       0.14155888</span></span>
<span><span class="co">#&gt; m7.1  0.2740303    0.26299556     0.1597568       0.15438156       0.22118544</span></span>
<span><span class="co">#&gt; m8.1  0.1551582    0.25878997     0.2250104       0.11676329       0.11342068</span></span>
<span><span class="co">#&gt; m9.1  0.4112988    0.18544249     0.3031930       0.25437898       0.15945532</span></span>
<span><span class="co">#&gt; m10.1 0.1031899    0.07678759     0.1099667       0.08735893       0.08499412</span></span>
<span><span class="co">#&gt;       PrecisionSD   RecallSD       F1SD PrevalenceSD Detection RateSD</span></span>
<span><span class="co">#&gt; m1.2   0.06069253 0.09034932 0.03072865   0.03674235       0.05769460</span></span>
<span><span class="co">#&gt; m2.2   0.14893707 0.36677275 0.22613473   0.00000000       0.18322732</span></span>
<span><span class="co">#&gt; m3.2   0.27570576 0.30009262 0.23154751   0.03674235       0.17164571</span></span>
<span><span class="co">#&gt; m4.2   0.14155888 0.10679693 0.08493331   0.05196152       0.08669102</span></span>
<span><span class="co">#&gt; m5.2   0.26728636 0.26300618 0.20902532   0.03674235       0.13392286</span></span>
<span><span class="co">#&gt; m6.2   0.19225764 0.20615528 0.09577186   0.03674235       0.09386648</span></span>
<span><span class="co">#&gt; m7.2   0.14218884 0.21665391 0.12100000   0.03674235       0.08033835</span></span>
<span><span class="co">#&gt; m8.2   0.25208778 0.18045221 0.14719007   0.03674235       0.08966001</span></span>
<span><span class="co">#&gt; m9.2   0.18580366 0.25163913 0.13103784   0.00000000       0.12585276</span></span>
<span><span class="co">#&gt; m10.2  0.15245190 0.28081236 0.14525696   0.03674235       0.11998160</span></span>
<span><span class="co">#&gt; m1.1   0.20830006 0.22173558 0.20286120   0.00000000       0.11086779</span></span>
<span><span class="co">#&gt; m2.1   0.16174981 0.25578507 0.20366864   0.03674235       0.14237626</span></span>
<span><span class="co">#&gt; m3.1   0.08350000 0.27537853 0.15502339   0.03674235       0.12927071</span></span>
<span><span class="co">#&gt; m4.1   0.09885680 0.23629078 0.15483190   0.05196152       0.11709362</span></span>
<span><span class="co">#&gt; m5.1   0.11368377 0.24494897 0.12678952   0.03674235       0.11340598</span></span>
<span><span class="co">#&gt; m6.1   0.13456845 0.13731563 0.12157028   0.03674235       0.09375322</span></span>
<span><span class="co">#&gt; m7.1   0.15438156 0.26299556 0.17110888   0.03674235       0.13029326</span></span>
<span><span class="co">#&gt; m8.1   0.11676329 0.25878997 0.16907001   0.05196152       0.12869343</span></span>
<span><span class="co">#&gt; m9.1   0.25437898 0.18544249 0.18328916   0.03674235       0.11605566</span></span>
<span><span class="co">#&gt; m10.1  0.08735893 0.07678759 0.05300000   0.03674235       0.05238957</span></span>
<span><span class="co">#&gt;       Detection PrevalenceSD Balanced AccuracySD AccuracySD    KappaSD</span></span>
<span><span class="co">#&gt; m1.2              0.11452911          0.05162283 0.04697872 0.09998125</span></span>
<span><span class="co">#&gt; m2.2              0.28644546          0.17503976 0.17503976 0.34996035</span></span>
<span><span class="co">#&gt; m3.2              0.22464843          0.22321738 0.23003098 0.45108979</span></span>
<span><span class="co">#&gt; m4.2              0.13600000          0.09325413 0.08712587 0.17922146</span></span>
<span><span class="co">#&gt; m5.2              0.16812495          0.19601594 0.19138682 0.38882419</span></span>
<span><span class="co">#&gt; m6.2              0.20477467          0.07824481 0.08337466 0.16171039</span></span>
<span><span class="co">#&gt; m7.2              0.12065516          0.11103903 0.10831551 0.21652925</span></span>
<span><span class="co">#&gt; m8.2              0.22183252          0.17914426 0.18591642 0.36296132</span></span>
<span><span class="co">#&gt; m9.2              0.25707765          0.09741107 0.09741107 0.19520651</span></span>
<span><span class="co">#&gt; m10.2             0.18805850          0.09706827 0.09109839 0.18582317</span></span>
<span><span class="co">#&gt; m1.1              0.12717016          0.20813998 0.20813998 0.41635992</span></span>
<span><span class="co">#&gt; m2.1              0.10960687          0.15713900 0.15177478 0.31321598</span></span>
<span><span class="co">#&gt; m3.1              0.18407426          0.13936373 0.13576696 0.27707445</span></span>
<span><span class="co">#&gt; m4.1              0.16559489          0.12997179 0.13650000 0.26464111</span></span>
<span><span class="co">#&gt; m5.1              0.18805850          0.10626696 0.11237734 0.21420706</span></span>
<span><span class="co">#&gt; m6.1              0.11117966          0.11774938 0.11742622 0.23462363</span></span>
<span><span class="co">#&gt; m7.1              0.13559867          0.13688681 0.13708240 0.27430761</span></span>
<span><span class="co">#&gt; m8.1              0.22854813          0.07744837 0.07430119 0.15446979</span></span>
<span><span class="co">#&gt; m9.1              0.14564426          0.20572372 0.20551135 0.40479542</span></span>
<span><span class="co">#&gt; m10.1             0.07762463          0.05168494 0.05048680 0.10165464</span></span>
<span><span class="co">#&gt;       AccuracyLowerSD AccuracyUpperSD AccuracyNullSD AccuracyPValueSD</span></span>
<span><span class="co">#&gt; m1.2       0.05403702      0.01857193     0.02598076       0.07144928</span></span>
<span><span class="co">#&gt; m2.2       0.15509433      0.08752523     0.00000000       0.24909971</span></span>
<span><span class="co">#&gt; m3.2       0.21830464      0.11674188     0.02598076       0.41446783</span></span>
<span><span class="co">#&gt; m4.2       0.11068424      0.02412468     0.00000000       0.07261543</span></span>
<span><span class="co">#&gt; m5.2       0.16574353      0.10176566     0.02598076       0.34794767</span></span>
<span><span class="co">#&gt; m6.2       0.07824481      0.02776689     0.02598076       0.08525061</span></span>
<span><span class="co">#&gt; m7.2       0.11402485      0.04040627     0.02598076       0.08547319</span></span>
<span><span class="co">#&gt; m8.2       0.20823764      0.07155126     0.02598076       0.26088248</span></span>
<span><span class="co">#&gt; m9.2       0.10871829      0.04196328     0.00000000       0.15777912</span></span>
<span><span class="co">#&gt; m10.2      0.09361446      0.04138438     0.02598076       0.14635459</span></span>
<span><span class="co">#&gt; m1.1       0.23295833      0.07768902     0.00000000       0.26509039</span></span>
<span><span class="co">#&gt; m2.1       0.13740300      0.07320291     0.02598076       0.28758941</span></span>
<span><span class="co">#&gt; m3.1       0.11981201      0.08327615     0.02598076       0.32849188</span></span>
<span><span class="co">#&gt; m4.1       0.14142843      0.05166156     0.00000000       0.17686435</span></span>
<span><span class="co">#&gt; m5.1       0.09072440      0.06376193     0.02598076       0.23272588</span></span>
<span><span class="co">#&gt; m6.1       0.10045355      0.06394985     0.02598076       0.18938849</span></span>
<span><span class="co">#&gt; m7.1       0.13664156      0.06783067     0.02598076       0.24933512</span></span>
<span><span class="co">#&gt; m8.1       0.07109383      0.05109713     0.00000000       0.17712966</span></span>
<span><span class="co">#&gt; m9.1       0.19425327      0.10232139     0.02598076       0.37241643</span></span>
<span><span class="co">#&gt; m10.1      0.05696783      0.02466272     0.02598076       0.13087494</span></span>
<span><span class="co">#&gt;       McnemarPValueSD PositiveSD NegativeSD True PositiveSD False PositiveSD</span></span>
<span><span class="co">#&gt; m1.2        0.2600000  0.5773503  0.5773503       0.5000000        0.5000000</span></span>
<span><span class="co">#&gt; m2.2        0.3845712  0.5773503  0.5773503       2.0615528        2.0615528</span></span>
<span><span class="co">#&gt; m3.2        0.4084820  0.5773503  0.5773503       1.8929694        1.7078251</span></span>
<span><span class="co">#&gt; m4.2        0.3002221  0.5773503  0.5773503       0.9574271        0.5773503</span></span>
<span><span class="co">#&gt; m5.2        0.3760000  0.5773503  0.5773503       1.2909944        1.4142136</span></span>
<span><span class="co">#&gt; m6.2        0.4341674  0.5773503  0.5773503       1.2583057        1.2583057</span></span>
<span><span class="co">#&gt; m7.2        0.3760000  0.5773503  0.5773503       0.9574271        1.2583057</span></span>
<span><span class="co">#&gt; m8.2        0.4243061  0.5773503  0.5773503       0.9574271        1.0000000</span></span>
<span><span class="co">#&gt; m9.2        0.3792132  0.5773503  0.5773503       1.7078251        1.2909944</span></span>
<span><span class="co">#&gt; m10.2       0.3150856  0.5773503  0.5773503       1.5000000        1.5000000</span></span>
<span><span class="co">#&gt; m1.1        0.2211252  0.5773503  0.5773503       1.4142136        1.2909944</span></span>
<span><span class="co">#&gt; m2.1        0.1915000  0.5773503  0.5773503       1.4142136        1.2909944</span></span>
<span><span class="co">#&gt; m3.1        0.3606183  0.5773503  0.5773503       1.7078251        1.5000000</span></span>
<span><span class="co">#&gt; m4.1        0.3606183  0.5773503  0.5773503       1.2909944        1.4142136</span></span>
<span><span class="co">#&gt; m5.1        0.2744534  0.5773503  0.5773503       0.9574271        1.5000000</span></span>
<span><span class="co">#&gt; m6.1        0.2666063  0.5773503  0.5773503       1.0000000        0.8164966</span></span>
<span><span class="co">#&gt; m7.1        0.2666063  0.5773503  0.5773503       1.7320508        1.4142136</span></span>
<span><span class="co">#&gt; m8.1        0.3631533  0.5773503  0.5773503       1.4142136        1.2909944</span></span>
<span><span class="co">#&gt; m9.1        0.1915000  0.5773503  0.5773503       1.2583057        0.9574271</span></span>
<span><span class="co">#&gt; m10.1       0.0000000  0.5773503  0.5773503       0.5000000        0.5773503</span></span>
<span><span class="co">#&gt;       True NegativeSD False NegativeSD</span></span>
<span><span class="co">#&gt; m1.2        1.1547005        0.5773503</span></span>
<span><span class="co">#&gt; m2.2        1.5000000        1.8929694</span></span>
<span><span class="co">#&gt; m3.2        1.7078251        1.7078251</span></span>
<span><span class="co">#&gt; m4.2        1.2583057        0.9574271</span></span>
<span><span class="co">#&gt; m5.2        1.2909944        1.8257419</span></span>
<span><span class="co">#&gt; m6.2        0.9574271        1.5000000</span></span>
<span><span class="co">#&gt; m7.2        0.5773503        0.8164966</span></span>
<span><span class="co">#&gt; m8.2        2.0615528        2.0615528</span></span>
<span><span class="co">#&gt; m9.2        1.5000000        1.5000000</span></span>
<span><span class="co">#&gt; m10.2       0.5000000        0.9574271</span></span>
<span><span class="co">#&gt; m1.1        1.8257419        1.2909944</span></span>
<span><span class="co">#&gt; m2.1        0.5000000        0.9574271</span></span>
<span><span class="co">#&gt; m3.1        0.9574271        0.9574271</span></span>
<span><span class="co">#&gt; m4.1        0.8164966        1.0000000</span></span>
<span><span class="co">#&gt; m5.1        0.9574271        1.2583057</span></span>
<span><span class="co">#&gt; m6.1        0.5773503        0.9574271</span></span>
<span><span class="co">#&gt; m7.1        0.9574271        0.9574271</span></span>
<span><span class="co">#&gt; m8.1        1.4142136        1.2909944</span></span>
<span><span class="co">#&gt; m9.1        1.5000000        1.7078251</span></span>
<span><span class="co">#&gt; m10.1       0.9574271        0.5773503</span></span></code></pre></div>
<p>Otherwise, the mean validation metric values per algorithm can also
be obtained with the following code:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/train_sdm.html">mean_validation_metrics</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`Salminus brasiliensis`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 53</span></span></span>
<span><span class="co">#&gt;   algo       ROC   TSS Sensitivity Specificity `Pos Pred Value` `Neg Pred Value`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> kknn     0.779 0.488       0.755       0.742            0.768            0.782</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> naive_b… 0.788 0.441       0.745       0.714            0.716            0.746</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 46 more variables: Precision &lt;dbl&gt;, Recall &lt;dbl&gt;, F1 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Prevalence &lt;dbl&gt;, `Detection Rate` &lt;dbl&gt;, `Detection Prevalence` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Balanced Accuracy` &lt;dbl&gt;, Accuracy &lt;dbl&gt;, Kappa &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AccuracyLower &lt;dbl&gt;, AccuracyUpper &lt;dbl&gt;, AccuracyNull &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AccuracyPValue &lt;dbl&gt;, McnemarPValue &lt;dbl&gt;, Positive &lt;dbl&gt;, Negative &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `True Positive` &lt;dbl&gt;, `False Positive` &lt;dbl&gt;, `True Negative` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `False Negative` &lt;dbl&gt;, ROCSD &lt;dbl&gt;, TSSSD &lt;dbl&gt;, SensitivitySD &lt;dbl&gt;, …</span></span></span></code></pre></div>
<p>After building predictions, it is possible to ensemble GCMs using
<code>gcms_ensembles</code> function and informing in the parameter
<code>gcms</code> which part of <code>scenarios_names(i)</code> should
be used to ensemble gcms. In this example, scenarios names are:
<code>c("ca_ssp245_2090", "ca_ssp585_2090", "mi_ssp245_2090", "mi_ssp585_2090")</code>.
Thus, if we set the parameter to <code>c("ca", "mi")</code> the function
searches through scenarios names for <code>"ca"</code> and
<code>"mi"</code> and remove these parts of scenarios names. What
remains, in the example, is:
<code>c("_ssp245_2090", "_ssp585_2090", "_ssp245_2090", "_ssp585_2090")</code>.
Then, the function ensembles scenarios with the same new names (note
that, by removing the gcms abbreviation, the remaining name repeats
itself two times). At the end, ensembles will be named after the new
names generated in this last step and are included in object
<code>i</code> scenarios.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gcms_ensembles.html">gcms_ensembles</a></span><span class="op">(</span><span class="va">i</span>, gcms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ca"</span>, <span class="st">"mi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `cell_id` -&gt; `cell_id...1`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `mean_occ_prob` -&gt; `mean_occ_prob...2`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `wmean_AUC` -&gt; `wmean_AUC...3`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `committee_avg` -&gt; `committee_avg...4`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `cell_id` -&gt; `cell_id...5`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `mean_occ_prob` -&gt; `mean_occ_prob...6`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `wmean_AUC` -&gt; `wmean_AUC...7`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `committee_avg` -&gt; `committee_avg...8`</span></span>
<span><span class="va">i</span></span>
<span><span class="co">#&gt;             caretSDM           </span></span>
<span><span class="co">#&gt; ...............................</span></span>
<span><span class="co">#&gt; Class                         : input_sdm</span></span>
<span><span class="co">#&gt; --------  Occurrences  --------</span></span>
<span><span class="co">#&gt; Species Names                 : Salminus brasiliensis </span></span>
<span><span class="co">#&gt; Number of presences           : 22 </span></span>
<span><span class="co">#&gt; Pseudoabsence methods         :</span></span>
<span><span class="co">#&gt;     Method to obtain PAs      : bioclim </span></span>
<span><span class="co">#&gt;     Number of PA sets         : 10 </span></span>
<span><span class="co">#&gt;     Number of PAs in each set : 22 </span></span>
<span><span class="co">#&gt; Data Cleaning                 : NAs, Capitals, Centroids, Geographically Duplicated, Identical Lat/Long, Institutions, Invalid, Non-terrestrial, Duplicated Cell (grid) </span></span>
<span><span class="co">#&gt; --------  Predictors  ---------</span></span>
<span><span class="co">#&gt; Number of Predictors          : 5 </span></span>
<span><span class="co">#&gt; Predictors Names              : LENGTH_KM, DIST_DN_KM, bio1, bio4, bio12 </span></span>
<span><span class="co">#&gt; Area (VIF)                    : all</span></span>
<span><span class="co">#&gt; Threshold                     : 0.5</span></span>
<span><span class="co">#&gt; Selected Variables (VIF)      : LENGTH_KM, DIST_DN_KM, bio1 </span></span>
<span><span class="co">#&gt; ---------  Scenarios  ---------</span></span>
<span><span class="co">#&gt; Number of Scenarios           : 5 </span></span>
<span><span class="co">#&gt; Scenarios Names               : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current </span></span>
<span><span class="co">#&gt; -----------  Models  ----------</span></span>
<span><span class="co">#&gt; Algorithms Names              : naive_bayes kknn </span></span>
<span><span class="co">#&gt; Variables Names               : LENGTH_KM DIST_DN_KM bio1 </span></span>
<span><span class="co">#&gt; Model Validation              :</span></span>
<span><span class="co">#&gt;     Method                    : repeatedcv </span></span>
<span><span class="co">#&gt;     Number                    : 4 </span></span>
<span><span class="co">#&gt;     Metrics                   :</span></span>
<span><span class="co">#&gt; $`Salminus brasiliensis`</span></span>
<span><span class="co">#&gt;          algo       ROC       TSS Sensitivity Specificity</span></span>
<span><span class="co">#&gt; 1        kknn 0.7793611 0.4883333       0.755      0.7425</span></span>
<span><span class="co">#&gt; 2 naive_bayes 0.7883889 0.4408333       0.745      0.7142</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------  Predictions  --------</span></span>
<span><span class="co">#&gt; Ensembles                     :</span></span>
<span><span class="co">#&gt;     Scenarios                 : ca_ssp245_2090 ca_ssp585_2090 mi_ssp245_2090 mi_ssp585_2090 current _ssp245_2090 _ssp585_2090 </span></span>
<span><span class="co">#&gt;     Methods                   : mean_occ_prob wmean_AUC committee_avg </span></span>
<span><span class="co">#&gt; Thresholds                    :</span></span>
<span><span class="co">#&gt;     Method                    : threshold </span></span>
<span><span class="co">#&gt;     Criteria                  : 0.7</span></span></code></pre></div>
<p>Note that now the section “Predictions” has two scenarios called
_ssp245_2090 and _ssp585_2090, which are the GCM’s ensembles that we
have calculated.</p>
</div>
<div class="section level3">
<h3 id="plotting-results">Plotting results<a class="anchor" aria-label="anchor" href="#plotting-results"></a>
</h3>
<p>To plot results, we prepared plot and mapview functions. Here we
present only the plot versions due to mapview limitations for markdown,
but we encourage users to use the mapview alternatives every time it is
possible. To do that, simply alternate the “plot” portion of functions
to “mapview”. As an example, <code>plot_occurrences</code> has its
counterpart function <code>mapview_occurrences</code> with the same set
of arguments an functioning. For plot_predictions, we can set some
parameters to control what is being plotted. Probably the most important
parameter is the <code>scenario</code>, which user can change to plot
every different scenario projected. If you are modeling more than one
species you can inform the correct species to be plotted using the
<code>spp_name</code> parameter and if you are wealling to debate
separate projections you can plot them informing the model
<code>id</code> (see row names of <code>get_validation_metrics</code>
above to retrieve models ids).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_occurrences.html">plot_predictions</a></span><span class="op">(</span><span class="va">i</span>,</span>
<span>                 spp_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 scenario <span class="op">=</span> <span class="st">"current"</span>,</span>
<span>                 id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 ensemble <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 ensemble_type <span class="op">=</span> <span class="st">"mean_occ_prob"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Salminus_files/figure-html/plot_current_results-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_occurrences.html">plot_predictions</a></span><span class="op">(</span><span class="va">i</span>,</span>
<span>                 spp_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 scenario <span class="op">=</span> <span class="st">"_ssp245_2090"</span>,</span>
<span>                 id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 ensemble <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 ensemble_type <span class="op">=</span> <span class="st">"mean_occ_prob"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Salminus_files/figure-html/ssp245_2090-1.png" width="700"></p>
<p>Another plot widely used in SDM studies is the Partial Dependence
Plot, which informs the response curves to each variable. In
<code>caretSDM</code> these plots can be plotted using the
<code>pdp_sdm</code> function.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pdp_sdm.html">pdp_sdm</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="Salminus_files/figure-html/pdp_sdm-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="writting-results">Writting results<a class="anchor" aria-label="anchor" href="#writting-results"></a>
</h3>
<p>To export <code>caretSDM</code> objects and outputs from R you can
use the write functions. For all possibilities see the help file
<code><a href="../reference/write_ensembles.html">?write_ensembles</a></code>. We encourage users to use standard path
configuration, which organizes outputs in a straightforward fashion.
Common functions are the following:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write_ensembles.html">write_occurrences</a></span><span class="op">(</span><span class="va">i</span>, path <span class="op">=</span> <span class="st">"results/occurrences.csv"</span>, grid <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write_ensembles.html">write_pseudoabsences</a></span><span class="op">(</span><span class="va">i</span>, path <span class="op">=</span> <span class="st">"results/pseudoabsences"</span>, ext <span class="op">=</span> <span class="st">".csv"</span>, centroid <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write_ensembles.html">write_grid</a></span><span class="op">(</span><span class="va">i</span>, path <span class="op">=</span> <span class="st">"results/grid_study_area.gpkg"</span>, centroid <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write_ensembles.html">write_ensembles</a></span><span class="op">(</span><span class="va">i</span>, path <span class="op">=</span> <span class="st">"results/ensembles"</span>, ext <span class="op">=</span> <span class="st">".tif"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This vignette demonstrates how to build Species Distribution Models
with lines as predictor variables using <code>caretSDM</code>. This
vignette aimed to continental aquatic environments highlights the use of
the package using a line simplefeature in the <code>sdm_area</code>.
Alternative to that can be seen in vignettes(“Araucaria”, “caretSDM”)
where we build SDMs for a tree species using a grid simplefeatures
instead of lines.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">end_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">end_time</span> <span class="op">-</span> <span class="va">start_time</span></span>
<span><span class="co">#&gt; Time difference of 2.12842 mins</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dayani Bailly, Edivando Couto, José Hilário Delconte Ferreira, Marcos R. Lima, Reginaldo Ré, Valéria Batista, Luíz Fernando Esser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
