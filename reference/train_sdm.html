<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Train SDM models — train_sdm • caretSDM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Train SDM models — train_sdm"><meta name="description" content="This function is a wrapper to fit models in caret using caretSDM data."><meta property="og:description" content="This function is a wrapper to fit models in caret using caretSDM data."><meta property="og:image" content="https://luizesser.github.io/caretSDM/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">caretSDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/area_modeling.html">area_modeling</a></li>
    <li><a class="dropdown-item" href="../articles/lines_modeling.html">lines_modeling</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/luizesser/caretSDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Train SDM models</h1>
      <small class="dont-index">Source: <a href="https://github.com/luizesser/caretSDM/blob/main/R/train_sdm.R" class="external-link"><code>R/train_sdm.R</code></a></small>
      <div class="d-none name"><code>train_sdm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is a wrapper to fit models in caret using caretSDM data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">train_sdm</span><span class="op">(</span><span class="va">occ</span>,</span>
<span>          pred <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          <span class="va">algo</span>,</span>
<span>          ctrl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          variables_selected <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_tune_length</span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">algorithms_used</span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_models</span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_validation_metrics</span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mean_validation_metrics</span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-occ">occ<a class="anchor" aria-label="anchor" href="#arg-occ"></a></dt>
<dd><p>A <code>occurrences</code> or a <code>input_sdm</code> object.</p></dd>


<dt id="arg-pred">pred<a class="anchor" aria-label="anchor" href="#arg-pred"></a></dt>
<dd><p>A <code>predictors object</code>. If <code>occ</code> is a <code>input_sdm</code> object, then
<code>pred</code> is obtained from it.</p></dd>


<dt id="arg-algo">algo<a class="anchor" aria-label="anchor" href="#arg-algo"></a></dt>
<dd><p>A <code>character</code> vector. Algorithms to be used. For a complete list see
(https://topepo.github.io/caret/available-models.html). 'maxent', 'mahal.dist' and 'bioclim' are
also implemented, but they are only available to run alone, with no other algorithm together.</p></dd>


<dt id="arg-ctrl">ctrl<a class="anchor" aria-label="anchor" href="#arg-ctrl"></a></dt>
<dd><p>A <code>trainControl</code> object to be used to build models. See <code>trainControl</code>.</p></dd>


<dt id="arg-variables-selected">variables_selected<a class="anchor" aria-label="anchor" href="#arg-variables-selected"></a></dt>
<dd><p>A <code>vector</code> of variables to be used as predictors. If <code>NULL</code>,
predictors names from <code>pred</code> will be used. Can also be a selection method (e.g. 'vif').</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Should a paralelization method be used (not yet implemented)?</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to be passed to <code><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">caret::train</a></code> function.</p></dd>


<dt id="arg-i">i<a class="anchor" aria-label="anchor" href="#arg-i"></a></dt>
<dd><p>A <code>models</code> or a <code>input_sdm</code> object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>models</code> or a <code>input_sdm</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The object <code><a href="algorithms.html">algorithms</a></code> has a table comparing algorithms available. If the function
detects that the necessary packages are not available it will ask for installation. This will
happen just in the first time you use the algorithm.</p>
<p><code>get_tune_length</code> return the length used in grid-search for tunning.</p>
<p><code>algorithms_used</code> return the names of the algorithms used in the modeling process.</p>
<p><code>get_models</code> returns a <code>list</code> with trained models (class <code>train</code>) to each species.</p>
<p><code>get_validation_metrics</code> return a <code>list</code> with a <code>data.frame</code> to each species
with complete values for ROC, Sensitivity, Specificity, with their respectives Standard
Deviations (SD) and TSS to each of the algorithms and pseudoabsence datasets used.</p>
<p><code>mean_validation_metrics</code> return a <code>list</code> with a <code>tibble</code> to each species
summarizing values for ROC, Sensitivity, Specificity and TSS to each of the algorithms used.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="input_sdm.html">input_sdm</a> <a href="sdm_area.html">sdm_area</a> <a href="algorithms.html">algorithms</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create sdm_area object:</span></span></span>
<span class="r-in"><span><span class="va">sa</span> <span class="op">&lt;-</span> <span class="fu"><a href="sdm_area.html">sdm_area</a></span><span class="op">(</span><span class="va">parana</span>, cell_size <span class="op">=</span> <span class="fl">25000</span>, crs <span class="op">=</span> <span class="fl">6933</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> Making grid over study area is an expensive task. Please, be patient!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Include predictors:</span></span></span>
<span class="r-in"><span><span class="va">sa</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_predictors.html">add_predictors</a></span><span class="op">(</span><span class="va">sa</span>, <span class="va">bioc</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bio01"</span>, <span class="st">"bio12"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> Making grid over the study area is an expensive task. Please, be patient!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Using GDAL to make the grid and resample the variables.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in dplyr::select(x$grid, ...):</span> Can't select columns that don't exist.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">✖</span> Column `bio01` doesn't exist.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Include scenarios:</span></span></span>
<span class="r-in"><span><span class="va">sa</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_scenarios.html">add_scenarios</a></span><span class="op">(</span><span class="va">sa</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create occurrences:</span></span></span>
<span class="r-in"><span><span class="va">oc</span> <span class="op">&lt;-</span> <span class="fu"><a href="occurrences_sdm.html">occurrences_sdm</a></span><span class="op">(</span><span class="va">occ</span>, crs <span class="op">=</span> <span class="fl">6933</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="join_area.html">join_area</a></span><span class="op">(</span><span class="va">sa</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some records from `occ` do not fall in `pred`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> 2 elements from `occ` were excluded.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> If this seems too much, check how `occ` and `pred` intersect.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create input_sdm:</span></span></span>
<span class="r-in"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="input_sdm.html">input_sdm</a></span><span class="op">(</span><span class="va">oc</span>, <span class="va">sa</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Clean coordinates:</span></span></span>
<span class="r-in"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="data_clean.html">data_clean</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cell_ids identified, removing duplicated cell_id.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Testing country capitals</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed 0 records.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Testing country centroids</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed 0 records.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Testing duplicates</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed 0 records.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Testing equal lat/lon</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed 0 records.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Testing biodiversity institutions</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed 1 records.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Testing coordinate validity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed 0 records.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Testing sea coordinates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reading layer `ne_110m_land' from data source `/tmp/RtmpBV0kIY/ne_110m_land.shp' using driver `ESRI Shapefile'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 127 features and 3 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: -180 ymin: -90 xmax: 180 ymax: 83.64513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geodetic CRS:  WGS 84</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed 0 records.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predictors identified, procceding with grid filter (removing NA and duplicated data).</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># VIF calculation:</span></span></span>
<span class="r-in"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="vif_predictors.html">vif_predictors</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>the standard deviation is zero</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in xcor[mx[1], mx[2]]:</span> subscript out of bounds</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pseudoabsence generation:</span></span></span>
<span class="r-in"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu">pseudoabsence</span><span class="op">(</span><span class="va">i</span>, method<span class="op">=</span><span class="st">"bioclim"</span>, variables_selected <span class="op">=</span> <span class="st">"vif"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in pseudoabsence(i, method = "bioclim", variables_selected = "vif"):</span> could not find function "pseudoabsence"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Custom trainControl:</span></span></span>
<span class="r-in"><span><span class="va">ctrl_sdm</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">trainControl</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"repeatedcv"</span>, number <span class="op">=</span> <span class="fl">4</span>, repeats <span class="op">=</span> <span class="fl">10</span>, classProbs <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>returnResamp <span class="op">=</span> <span class="st">"all"</span>, summaryFunction <span class="op">=</span> <span class="va">summary_sdm</span>, savePredictions <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Train models:</span></span></span>
<span class="r-in"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu">train_sdm</span><span class="op">(</span><span class="va">i</span>, algo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nnet"</span>, <span class="st">"kknn"</span><span class="op">)</span>, variables_selected <span class="op">=</span> <span class="st">"vif"</span>, ctrl<span class="op">=</span><span class="va">ctrl_sdm</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in rep("pseudoabsence", nrow(pa)):</span> invalid 'times' argument</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dayani Bailly, Edivando Couto, José Hilário Delconte Ferreira, Reginaldo Ré, Valéria Batista, Luíz Esser.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

